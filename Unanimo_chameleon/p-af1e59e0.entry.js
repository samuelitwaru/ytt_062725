import{r as e,c as t,g as i,h as s,H as n}from"./p-7af91c05.js";import{b as o,f as r}from"./p-0978aac4.js";import{S as h}from"./p-2a2bca47.js";const c="--ch-popover-separation-x";const a="--ch-popover-separation-y";const l={"outside-start":"outside-end","outside-end":"outside-start","inside-start":"inside-end","inside-end":"inside-start"};const d=(e,t,i,s)=>t<i+e+s||e+s<0;const p={"outside-start":(e,t,i)=>-t-i,"inside-start":(e,t,i)=>i,center:(e,t,i)=>e*.5+i-t*.5,"inside-end":(e,t,i)=>e-(i+t),"outside-end":(e,t,i)=>e+i};const v=e=>Number(e.replace("px","").trim());const u=(e,t,i,s,n,o,r)=>{const h=p[e](i,s,o);if(!r){return h}const c=d(t,n,s,h);if(!c){return h}const a=l[e];const v=p[a](i,s,o);const u=d(t,n,s,v);return u?h:v};const b=(e,t,i,s,n,o,r,h,l)=>{const d=o.getPropertyValue(c);const p=o.getPropertyValue(a);const b=u(r,i,t.width,s,e.width,v(d),r!=="center"&&l==="flip-inline");const f=u(h,t.top,t.height,n,e.height,v(p),h!=="center"&&l==="flip-block");return[b,f]};const f="*,::after,::before{-webkit-box-sizing:border-box;box-sizing:border-box}:host{--ch-popover-block-size:max-content;--ch-popover-inline-size:max-content;--ch-popover-max-block-size:auto;--ch-popover-max-inline-size:auto;--ch-popover-min-block-size:auto;--ch-popover-min-inline-size:auto;--ch-popover-resize-threshold:8px;--ch-popover-separation-x:0px;--ch-popover-separation-y:0px;--ch-popover-resize-threshold--half-negative:calc(\n    var(--ch-popover-resize-threshold) * -0.5\n  );--ch-popover-border-inline-start-width:0px;--ch-popover-border-inline-end-width:0px;--ch-popover-border-block-start-width:0px;--ch-popover-border-block-end-width:0px;--ch-popover-resize__inline-start:calc(\n    var(--ch-popover-resize-threshold--half-negative) -\n      var(--ch-popover-border-inline-start-width) * 0.5\n  );--ch-popover-resize__inline-end:calc(\n    var(--ch-popover-resize-threshold--half-negative) -\n      var(--ch-popover-border-inline-end-width) * 0.5\n  );--ch-popover-resize__block-start:calc(\n    var(--ch-popover-resize-threshold--half-negative) -\n      var(--ch-popover-border-block-start-width) * 0.5\n  );--ch-popover-resize__block-end:calc(\n    var(--ch-popover-resize-threshold--half-negative) -\n      var(--ch-popover-border-block-end-width) * 0.5\n  );--ch-popover-dragged-x:0px;--ch-popover-dragged-y:0px;--ch-popover-rtl:1;display:grid;position:fixed;inline-size:var(--ch-popover-inline-size);block-size:var(--ch-popover-block-size);min-inline-size:var(--ch-popover-min-inline-size);min-block-size:var(--ch-popover-min-block-size);max-inline-size:var(--ch-popover-max-inline-size);max-block-size:var(--ch-popover-max-block-size);margin:0;padding:0;background-color:unset;border:unset;color:unset;overflow:visible;top:0;inset-inline-start:0;translate:calc((var(--ch-popover-action-left) + var(--ch-popover-inline) + var(--ch-popover-dragged-x)) * var(--ch-popover-rtl)) calc(var(--ch-popover-action-top) + var(--ch-popover-block) + var(--ch-popover-dragged-y))}:host(.gx-popover-prevent-flickering){visibility:hidden !important}:host(.gx-popover-header-drag){display:grid;grid-template-rows:-webkit-max-content 1fr;grid-template-rows:max-content 1fr}:host(.gx-popover-dragging){cursor:move}:host(.gx-popover-dragging) ::slotted(*){pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}:host(.ch-popover-resizing){pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.edge__block-start,.edge__block-end{position:fixed;inset-inline:min(0px, (var(--ch-popover-resize-threshold) - var(--ch-popover-border-inline-start-width)) / 2) min(0px, (var(--ch-popover-resize-threshold) - var(--ch-popover-border-inline-end-width)) / 2);block-size:var(--ch-popover-resize-threshold);cursor:ns-resize}.edge__inline-start,.edge__inline-end{position:fixed;inset-block:min(0px, (var(--ch-popover-resize-threshold) - var(--ch-popover-border-block-start-width)) / 2) min(0px, (var(--ch-popover-resize-threshold) - var(--ch-popover-border-block-end-width)) / 2);inline-size:var(--ch-popover-resize-threshold);cursor:ew-resize}.edge__block-start{inset-block-start:var(--ch-popover-resize__block-start)}.edge__block-end{inset-block-end:var(--ch-popover-resize__block-end)}.edge__inline-start{inset-inline-start:var(--ch-popover-resize__inline-start)}.edge__inline-end{inset-inline-end:var(--ch-popover-resize__inline-end)}.corner__block-start-inline-start,.corner__block-end-inline-end{position:fixed;block-size:var(--ch-popover-resize-threshold);inline-size:var(--ch-popover-resize-threshold);cursor:nwse-resize}.corner__block-start-inline-end,.corner__block-end-inline-start{position:fixed;block-size:var(--ch-popover-resize-threshold);inline-size:var(--ch-popover-resize-threshold);cursor:nesw-resize}.corner__block-start-inline-start{inset-block-start:var(--ch-popover-resize__block-start);inset-inline-start:var(--ch-popover-resize__inline-start)}.corner__block-end-inline-end{inset-block-end:var(--ch-popover-resize__block-end);inset-inline-end:var(--ch-popover-resize__inline-end)}.corner__block-start-inline-end{inset-block-start:var(--ch-popover-resize__block-start);inset-inline-end:var(--ch-popover-resize__inline-end)}.corner__block-end-inline-start{inset-block-end:var(--ch-popover-resize__block-end);inset-inline-start:var(--ch-popover-resize__inline-start)}:host(.ch-popover-rtl) .corner__block-start-inline-start,:host(.ch-popover-rtl) .corner__block-end-inline-end{cursor:nesw-resize}:host(.ch-popover-rtl) .corner__block-start-inline-end,:host(.ch-popover-rtl) .corner__block-end-inline-start{cursor:nwse-resize}.resize-layer{position:fixed;inset:0;pointer-events:none}";const z=f;const k="gx-popover-dragging";const g="gx-popover-prevent-flickering";const m="ch-popover-resizing";const _="--ch-popover-block";const w="--ch-popover-inline";const x="--ch-popover-action-width";const y="--ch-popover-action-height";const C="--ch-popover-action-left";const D="--ch-popover-action-top";const S="--ch-popover-dragged-x";const A="--ch-popover-dragged-y";const R="--ch-popover-block-size";const F="--ch-popover-inline-size";const M="--ch-popover-min-block-size";const W="--ch-popover-min-inline-size";const E="--ch-popover-border-block-start-width";const I="--ch-popover-border-block-end-width";const B="--ch-popover-border-inline-start-width";const O="--ch-popover-border-inline-end-width";const P="ch-popover-rtl";const j="--ch-popover-rtl";const N="-1";const T=e=>document.body.style.cursor=e;const q={"block-start":()=>T("ns-resize"),"block-end":()=>T("ns-resize"),"inline-start":()=>T("ew-resize"),"inline-end":()=>T("ew-resize"),"block-start-inline-start":e=>T(e?"nesw-resize":"nwse-resize"),"block-start-inline-end":e=>T(e?"nwse-resize":"nesw-resize"),"block-end-inline-start":e=>T(e?"nwse-resize":"nesw-resize"),"block-end-inline-end":e=>T(e?"nesw-resize":"nwse-resize")};const H=(e,t,i)=>e.style.setProperty(t,`${i}px`);const L=(e,t,i)=>{if(e&&i){e.popoverTargetElement=t}};const X=e=>{if(e){e.popoverTargetElement=undefined}};const Y=class{constructor(i){e(this,i);this.popoverOpened=t(this,"popoverOpened",7);this.popoverClosed=t(this,"popoverClosed",7);this.resizing=false;this.actionById=false;this.actionElement=undefined;this.allowDrag="no";this.blockAlign="center";this.blockSizeMatch="content";this.closeOnClickOutside=false;this.firstLayer=true;this.hidden=true;this.inlineAlign="center";this.inlineSizeMatch="content";this.mode="auto";this.positionTry="none";this.resizable=false}#e;#t;#i;#s;#n=false;#o=false;#r=false;#h;#c;#a;#l=0;#d=0;#p=false;#v;#u;#b;#f;#z=0;#k=0;#g=0;#m=0;#_=0;#w=0;#x=false;#y={block:(e,t)=>{let i=this.#u.clientY-this.#v.clientY;if(t==="start"){i=-i}const s=e.height+i;const n=r(s,this.#_,this.#g);if(n===e.height){return}if(t==="start"){this.#k-=i;H(this.el,A,this.#k)}H(this.el,R,n)},inline:(e,t)=>{let i=this.#u.clientX-this.#v.clientX;if(this.#b){i=-i}if(t==="start"){i=-i}const s=e.width+i;const n=r(s,this.#w,this.#m);if(n===e.width){return}if(t==="start"){this.#z-=i;H(this.el,S,this.#z)}H(this.el,F,n)}};#C={"block-start":e=>this.#y.block(e,"start"),"block-end":e=>this.#y.block(e,"end"),"inline-start":e=>this.#y.inline(e,"start"),"inline-end":e=>this.#y.inline(e,"end"),"block-start-inline-start":e=>{this.#y.block(e,"start");this.#y.inline(e,"start")},"block-start-inline-end":e=>{this.#y.block(e,"start");this.#y.inline(e,"end")},"block-end-inline-start":e=>{this.#y.block(e,"end");this.#y.inline(e,"start")},"block-end-inline-end":e=>{this.#y.block(e,"end");this.#y.inline(e,"end")}};#D;#S;get el(){return i(this)}handleActionChange(e,t){this.#l=0;this.#d=0;X(t);L(e,this.el,!this.actionById);this.#o=true}handleBlockChange(){this.#n=true}blockSizeWatchChange(e){if(this.#x){return}if(e==="content"){this.el.style.removeProperty(R);this.el.style.removeProperty(M)}else if(e==="action-element"){this.el.style.removeProperty(M)}else{this.el.style.removeProperty(R)}this.#n=true}handleHiddenChange(e){this.#r=true;this.#o=true;if(e){if(this.firstLayer){this.#A(true)}this.el.hidePopover()}else{this.#R()}}handleInlineChange(){this.#n=true}inlineSizeWatchChange(e){if(this.#x){return}if(e==="content"){this.el.style.removeProperty(F);this.el.style.removeProperty(W)}else if(e==="action-element"){this.el.style.removeProperty(W)}else{this.el.style.removeProperty(F)}this.#n=true}resizableChanged(){this.#r=true}popoverOpened;popoverClosed;#R=()=>{this.el.showPopover();this.#F()};#M=e=>{if(!e.composedPath().includes(this.el)){this.#W();this.hidden=true;this.popoverClosed.emit()}};#F=()=>{if(this.mode==="manual"&&this.closeOnClickOutside){document.addEventListener("click",this.#M,{passive:true})}};#W=()=>{document.removeEventListener("click",this.#M)};#E=()=>{if(!this.#p){this.el.classList.add(k);this.#p=true}};#I=()=>{this.el.classList.remove(k);this.#p=false};#A=e=>{if(e){this.el.classList.add(g)}else{this.el.classList.remove(g)}};#B=()=>{if(!this.actionElement||this.hidden){this.#O();return}if(this.#c){this.#c.disconnect()}this.#i??=new h;this.#c??=new ResizeObserver(this.#P);this.#c.observe(this.actionElement);this.#c.observe(this.el);this.#j();if(this.firstLayer){requestAnimationFrame((()=>{this.#A(false)}))}this.#S.addEventListener("resize",this.#P,{passive:true});document.addEventListener("scroll",this.#P,{capture:true,passive:true})};#P=()=>{this.#i.perform(this.#j)};#j=()=>{const e=document.documentElement.getBoundingClientRect();const t=this.actionElement.getBoundingClientRect();const i=this.el.getBoundingClientRect();const s=getComputedStyle(this.el);const n=this.#N(e,t);this.#T(e,t,n,i,s);H(this.el,x,t.width);H(this.el,y,t.height);H(this.el,C,n);H(this.el,D,t.top)};#N=(e,t)=>this.#b?e.width-(t.left+t.width):t.left;#T=(e,t,i,s,n)=>{const o=this.#q(t,s);const r=this.#H(t,s);const h=b(e,t,i,o,r,n,this.inlineAlign,this.blockAlign,this.positionTry);H(this.el,w,h[0]);H(this.el,_,h[1])};#q=(e,t)=>{if(this.inlineSizeMatch==="action-element-as-minimum"){H(this.el,W,e.width);return e.width}if(this.#x||this.inlineSizeMatch==="content"){return t.width}H(this.el,F,e.width);return e.width};#H=(e,t)=>{if(this.blockSizeMatch==="action-element-as-minimum"){H(this.el,M,e.height);return e.height}if(this.#x||this.blockSizeMatch==="content"){return t.height}H(this.el,R,e.height);return e.height};#O=()=>{if(this.#c){this.#c.disconnect();this.#c=null}this.#S.removeEventListener("resize",this.#P);document.removeEventListener("scroll",this.#P,{capture:true})};#L=e=>{const t=!(e.newState==="open");this.hidden=t;if(t){this.popoverClosed.emit()}else{this.popoverOpened.emit()}};#X=e=>{this.#t||=new h;this.#v=e;document.addEventListener("mousemove",this.#Y,{capture:true});document.addEventListener("mouseup",this.#$,{capture:true,passive:true})};#Y=e=>{this.#t.perform(this.#G,(()=>{e.preventDefault();this.#E();this.#u=e}))};#G=()=>{const e=this.#u.clientX-this.#v.clientX;const t=this.#u.clientY-this.#v.clientY;if(e!==0){this.#l+=this.#b?-e:e;H(this.el,S,this.#l)}if(t!==0){this.#d+=t;H(this.el,A,this.#d)}this.#v=this.#u};#$=()=>{if(this.#t){this.#t.cancel()}document.removeEventListener("mousemove",this.#Y,{capture:true});document.removeEventListener("mouseup",this.#$,{capture:true});this.#I();this.#t=null;this.#v=null;this.#u=null};#J=e=>t=>{this.resizing=true;this.#s||=new h;this.#f=e;this.#v=t;q[this.#f](this.#b);this.#z=this.#l;this.#k=this.#d;const i=getComputedStyle(this.el);this.#g=v(i.maxBlockSize);this.#m=v(i.maxInlineSize);this.#_=v(i.minBlockSize);this.#w=v(i.minInlineSize);this.#O();this.#K();this.#W();document.addEventListener("mousemove",this.#Q,{capture:true});document.addEventListener("mouseup",this.#U,{capture:true,passive:true})};#Q=e=>{this.#s.perform(this.#V,(()=>{e.preventDefault();this.#E();this.#u=e}))};#V=()=>{const e=this.el.getBoundingClientRect();this.#C[this.#f](e);this.#x=true;this.#v=this.#u};#U=()=>{this.resizing=false;if(this.#s){this.#s.cancel()}document.body.style.cursor=null;H(this.el,S,this.#l);H(this.el,A,this.#d);this.#B();this.#Z();requestAnimationFrame(this.#F);document.removeEventListener("mousemove",this.#Q,{capture:true});document.removeEventListener("mouseup",this.#U,{capture:true});this.#I();this.#s=null;this.#v=null;this.#u=null};#Z=()=>{if(!this.resizable||this.hidden){this.#K();return}this.#e??=new h;this.#h=new ResizeObserver(this.#ee);this.#h.observe(this.el,{box:"border-box"});this.#h.observe(this.#D)};#ee=()=>{this.#e.perform(this.#te)};#te=()=>{const e=getComputedStyle(this.el);this.el.style.setProperty(E,e.borderBlockStartWidth);this.el.style.setProperty(I,e.borderBlockEndWidth);this.el.style.setProperty(B,e.borderInlineStartWidth);this.el.style.setProperty(O,e.borderInlineEndWidth)};#K=()=>{if(this.#h){this.#h.disconnect();this.#h=null}this.#e=null};connectedCallback(){this.#S=window;this.#a=new MutationObserver((()=>{this.#b=o();if(this.#b){this.el.style.setProperty(j,N);this.el.classList.add(P)}else{this.el.style.removeProperty(j);this.el.classList.remove(P)}}));if(this.firstLayer){this.#A(true)}this.#a.observe(document.documentElement,{attributeFilter:["dir"]})}componentWillRender(){if(this.#o){this.#o=false;this.#B()}if(this.#r){this.#r=false;requestAnimationFrame((()=>{this.#Z()}))}if(this.#n){const e=document.documentElement.getBoundingClientRect();const t=this.actionElement.getBoundingClientRect();const i=this.el.getBoundingClientRect();const s=getComputedStyle(this.el);const n=this.#N(e,t);this.#T(e,t,n,i,s)}}componentDidLoad(){L(this.actionElement,this.el,!this.actionById);this.#B();this.#Z();if(!this.hidden){this.#R()}}disconnectedCallback(){this.#O();this.#K();X(this.actionElement);this.#$();this.#W();if(this.#a){this.#a.disconnect();this.#a=null}}render(){const e=!this.hidden;return s(n,{key:"0861ff3749ce3cc25712cee1df73504da0615add",class:{"gx-popover-header-drag":e&&this.allowDrag==="header",[m]:this.resizing},popover:this.mode,onMouseDown:e&&this.allowDrag==="box"?this.#X:null,onToggle:this.#L},this.allowDrag==="header"&&s("div",{key:"db057a6577b25c3a3e7224bbd10c8e8f512569df",class:"header",part:"header",onMouseDown:e?this.#X:null},s("slot",{key:"69b7d806e44ce3a7a5a28e404d890f291fdb1de5",name:"header"})),s("slot",{key:"a8ef18b26fa30addf623f9ea773feca32822e87c"}),this.resizable&&!this.hidden&&[s("div",{key:"ea6f79d07ae52466d89161ab569c7d90c238abfe",class:"edge__block-start",onMouseDown:this.#J("block-start")}),s("div",{key:"c046b60e370435a9a838cb59dfd4b5dcc44756d7",class:"edge__inline-end",onMouseDown:this.#J("inline-end")}),s("div",{key:"4827bc59a27aadb0063658615d1ffe10935084af",class:"edge__block-end",onMouseDown:this.#J("block-end")}),s("div",{key:"9130311300f919bf6c42e660dcf668adec6758c6",class:"edge__inline-start",onMouseDown:this.#J("inline-start")}),s("div",{key:"cc5d1db4e1083278b8bb43dbbd2caa9c2b9bdaab",class:"corner__block-start-inline-start",onMouseDown:this.#J("block-start-inline-start")}),s("div",{key:"fff6da3ec192c28c8b3123f861ef59a8a737ee52",class:"corner__block-start-inline-end",onMouseDown:this.#J("block-start-inline-end")}),s("div",{key:"5a8bbb43a2f089a893ad21ab47ff40b721ab7e8f",class:"corner__block-end-inline-start",onMouseDown:this.#J("block-end-inline-start")}),s("div",{key:"e4c62fa9e8aa68e71873ee2f38e4c9e9c77f4dc9",class:"corner__block-end-inline-end",onMouseDown:this.#J("block-end-inline-end")}),s("div",{key:"0075aa74f3007192741cedd79ce36684629b1fda",class:"resize-layer",ref:e=>this.#D=e})])}static get watchers(){return{actionElement:["handleActionChange"],blockAlign:["handleBlockChange"],blockSizeMatch:["blockSizeWatchChange"],hidden:["handleHiddenChange"],inlineAlign:["handleInlineChange"],inlineSizeMatch:["inlineSizeWatchChange"],resizable:["resizableChanged"]}}};Y.style=z;export{Y as ch_popover};
//# sourceMappingURL=p-af1e59e0.entry.js.map