import{r as t,c as i,h as s,H as e,g as n}from"./p-f2da1e38.js";const h=class{constructor(s){t(this,s),this.windowOpened=i(this,"windowOpened",7),this.windowClosed=i(this,"windowClosed",7),this.xAlign="center",this.yAlign="center",this.hidden=!0,this.modal=!0,this.caption="",this.allowDrag="no",this.isContainerCssOverride=!1,this.validCssAligns=["outside-start","inside-start","center","inside-end","outside-end"],this.draggedX=0,this.draggedY=0,this.mousemoveHandler=t=>{const i=this.draggedY+t.clientY-this.dragStartY;this.window.style.setProperty("--ch-window-x-drag",this.draggedX+t.clientX-this.dragStartX+"px"),this.window.style.setProperty("--ch-window-y-drag",i+"px")},this.mouseupHandler=()=>{document.removeEventListener("mousemove",this.mousemoveHandler),this.draggedX=parseInt(this.window.style.getPropertyValue("--ch-window-x-drag")),this.draggedY=parseInt(this.window.style.getPropertyValue("--ch-window-y-drag"))},this.maskClickHandler=t=>{t.stopPropagation()},this.updatePosition=()=>{if(!this.isContainerCssOverride&&this.container&&this.mask){const t=this.container.getBoundingClientRect();this.mask.style.setProperty("inset-inline-start",t.left+"px"),this.mask.style.setProperty("inset-block-start",t.top+"px"),this.mask.style.width=t.width+"px",this.mask.style.height=t.height+"px"}else!this.isContainerCssOverride&&this.container||(this.mask.style.removeProperty("inset-inline-start"),this.mask.style.removeProperty("inset-block-start"),this.mask.style.removeProperty("width"),this.mask.style.removeProperty("height"))}}componentWillLoad(){this.containerResizeObserver=new ResizeObserver(this.updatePosition),this.containerResizeObserverHandler(this.container),this.watchCSSAlign()}containerHandler(t,i){this.containerResizeObserverHandler(t,i),this.updatePosition()}hiddenHandler(){this.hidden?(this.resetDrag(),this.windowClosed.emit()):(this.updatePosition(),this.windowOpened.emit())}windowResizeHandler(){this.watchCSSAlign()}documentClickHandler(t){this.closeOnOutsideClick&&!t.composedPath().includes(this.window)&&(this.hidden=!0)}documentKeyDownHandler(t){!this.hidden&&this.closeOnEscape&&"Escape"===t.key&&(this.hidden=!0)}windowScrollHandler(){this.container&&this.updatePosition()}mousedownHandler(t){this.isDraggable(t.composedPath())&&(this.dragStartX=t.clientX,this.dragStartY=t.clientY,document.addEventListener("mousemove",this.mousemoveHandler,{passive:!0}),document.addEventListener("mouseup",this.mouseupHandler,{once:!0}))}windowCloseClickedHandler(){this.hidden=!0}resetDrag(){this.dragStartX=void 0,this.dragStartY=void 0,this.draggedX=0,this.draggedY=0,this.window.style.removeProperty("--ch-window-x-drag"),this.window.style.removeProperty("--ch-window-y-drag")}isDraggable(t){return"no"!==this.allowDrag&&("header"===this.allowDrag&&t.includes(this.header)||"box"===this.allowDrag&&t.includes(this.window))}watchCSSAlign(){const t=getComputedStyle(this.el),i=t.getPropertyValue("--ch-window-container").trim(),s=t.getPropertyValue("--ch-window-x-align").trim(),e=t.getPropertyValue("--ch-window-y-align").trim();this.isContainerCssOverride=!!i.includes("window"),this.validCssAligns.includes(s)&&(this.xAlign=s),this.validCssAligns.includes(e)&&(this.yAlign=e)}containerResizeObserverHandler(t,i){t&&this.containerResizeObserver.observe(t),i&&this.containerResizeObserver.unobserve(i)}render(){return s(e,null,s("div",{class:"mask",part:"mask",ref:t=>this.mask=t,onClick:this.maskClickHandler},s("section",{class:"window",part:"window",ref:t=>this.window=t},s("header",{part:"header",ref:t=>this.header=t},s("slot",{name:"header"},s("span",{part:"caption"},this.caption),s("ch-window-close",{part:"close",title:this.closeTooltip},this.closeText))),s("main",{part:"main"},s("slot",null)),s("footer",{part:"footer"},s("slot",{name:"footer"})))))}get el(){return n(this)}static get watchers(){return{container:["containerHandler"],hidden:["hiddenHandler"]}}};h.style=':host(:not([hidden])){display:contents}:host(:is(:not([modal]),[modal="false"])) .mask{pointer-events:none}.window{pointer-events:all}.mask{display:-ms-flexbox;display:flex;position:fixed;inset:0;z-index:var(--ch-window-mask-z-index, 1000)}:host(:is([x-align="outside-start"],[x-align="inside-start"])) .mask{-ms-flex-pack:start;justify-content:flex-start}:host([x-align=center]) .mask{-ms-flex-pack:center;justify-content:center}:host(:is([x-align="outside-end"],[x-align="inside-end"])) .mask{-ms-flex-pack:end;justify-content:flex-end}:host(:is([y-align="outside-start"],[y-align="inside-start"])) .mask{-ms-flex-align:start;align-items:flex-start}:host([y-align=center]) .mask{-ms-flex-align:center;align-items:center}:host(:is([y-align="outside-end"],[y-align="inside-end"])) .mask{-ms-flex-align:end;align-items:flex-end}.window{display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;-webkit-transform:translate(var(--ch-window-x-outside, 0px), var(--ch-window-y-outside, 0px)) translate(var(--ch-window-x-drag, 0px), var(--ch-window-y-drag, 0px));transform:translate(var(--ch-window-x-outside, 0px), var(--ch-window-y-outside, 0px)) translate(var(--ch-window-x-drag, 0px), var(--ch-window-y-drag, 0px))}:host([x-align=outside-start]) .window{--ch-window-x-outside:-100%}:host([x-align=outside-end]) .window{--ch-window-x-outside:100%}:host([y-align=outside-start]) .window{--ch-window-y-outside:-100%}:host([y-align=outside-end]) .window{--ch-window-y-outside:100%}';const o=class{constructor(s){t(this,s),this.windowCloseClicked=i(this,"windowCloseClicked",7),this.handleClick=t=>{t.stopPropagation(),this.windowCloseClicked.emit()}}render(){return s(e,{role:"button",tabindex:"0",disabled:this.disabled,onClick:this.handleClick})}};o.style="";export{h as ch_window,o as ch_window_close}