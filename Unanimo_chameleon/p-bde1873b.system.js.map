{"version":3,"names":["debounce","func","wait","immediate","timeout","args","_i","arguments","length","later","apply","this","bind","callNow","clearTimeout","setTimeout","isMobileDevice","exports","test","navigator","userAgent","ROOT_VIEW","overrideMethod","component","methodName","_a","before","after","oldMethod","undefined","call","tokenMap","tokens","keys","Object","result","index","tokenKey","tokenValue","concat","inBetween","x","y","z","resetDragImage","window","Image","removeDragImage","event","dataTransfer","setDragImage","isPseudoElementImg","src","imageType","forceCSSMinMax","value","minimum","maximum","Number","isNaN","Math","max","min","addCursorInDocument","cursor","document","documentElement","style","resetCursorInDocument","removePointerEventsInDocumentBody","body","pointerEvents","resetPointerEventsInDocumentBody","isRTL","dir","RTLWatcher","RTLSubscribers","setRTLWatcher","MutationObserver","size","rtlDirection","subscribers","__spreadArray","values","subscriberCallback","observe","attributeFilter","subscribeToRTLChanges","subscriberId","callback","Map","set","unsubscribeToRTLChanges","delete","disconnect"],"sources":["src/common/utils.ts"],"sourcesContent":["import { Component } from \"./interfaces\";\r\nimport { CssCursorProperty, ImageRender } from \"./types\";\r\n\r\nexport function debounce(\r\n  func: () => void,\r\n  wait: number,\r\n  immediate = false\r\n): () => void {\r\n  let timeout: NodeJS.Timeout;\r\n\r\n  return function (...args) {\r\n    const later = function () {\r\n      timeout = null;\r\n      if (!immediate) {\r\n        // @ts-expect-error: TODO: This function will be removed when we refactor line-clamp implementation. So we are avoiding this error\r\n        func.apply(this, args);\r\n      }\r\n      // @ts-expect-error: TODO: This function will be removed when we refactor line-clamp implementation. So we are avoiding this error\r\n    }.bind(this);\r\n\r\n    const callNow = immediate && !timeout;\r\n\r\n    clearTimeout(timeout);\r\n    timeout = setTimeout(later, wait);\r\n\r\n    if (callNow) {\r\n      // @ts-expect-error: TODO: This function will be removed when we refactor line-clamp implementation. So we are avoiding this error\r\n      func.apply(this, args);\r\n    }\r\n  };\r\n}\r\n\r\nexport const isMobileDevice = () =>\r\n  /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(\r\n    navigator.userAgent\r\n  );\r\n\r\nexport const ROOT_VIEW: null = null;\r\n\r\n/*  This functions overrides a method adding calls before (`before()`) and\r\n    after (`after()`) \r\n*/\r\nexport function overrideMethod(\r\n  component: Component,\r\n  methodName: string,\r\n  { before, after }: { before?: () => void; after?: () => void }\r\n) {\r\n  const oldMethod = component[methodName];\r\n  component[methodName] = () => {\r\n    if (before !== undefined) {\r\n      before();\r\n    }\r\n\r\n    if (oldMethod !== undefined) {\r\n      oldMethod.call(component);\r\n    }\r\n\r\n    if (after !== undefined) {\r\n      after();\r\n    }\r\n  };\r\n}\r\n\r\n/**\r\n * Converts an object mapping token keys to booleans into a space-separated\r\n * string containing the token keys that map to truthy values.\r\n * @example\r\n *   part={tokenMap({\r\n *     header: true,\r\n *     disabled: this.disabled,\r\n *     selected: this.selected,\r\n *     [levelPart]: canShowLines,\r\n *     \"expand-button\":\r\n *       canShowLines && !this.leaf && this.expandableButton !== \"no\"\r\n *   })}\r\n */\r\nexport const tokenMap = (tokens: { [key: string]: boolean }) => {\r\n  const keys = Object.keys(tokens);\r\n  let result = \"\";\r\n\r\n  for (let index = 0; index < keys.length; index++) {\r\n    const tokenKey = keys[index];\r\n    const tokenValue = tokens[tokenKey];\r\n\r\n    if (tokenValue) {\r\n      result += result === \"\" ? tokenKey : ` ${tokenKey}`;\r\n    }\r\n  }\r\n\r\n  return result;\r\n};\r\n\r\n/**\r\n * `true` if `x` <= `y` <= `z`\r\n */\r\nexport const inBetween = (x: number, y: number, z: number) => x <= y && y <= z;\r\n\r\nlet resetDragImage;\r\n\r\n/* @__PURE__ */ if (!window.Image) {\r\n  resetDragImage = \"test\";\r\n}\r\n\r\nresetDragImage ??= new Image();\r\nexport const removeDragImage = (event: DragEvent) =>\r\n  event.dataTransfer.setDragImage(resetDragImage, 0, 0);\r\n\r\nexport const isPseudoElementImg = (src?: string, imageType?: ImageRender) =>\r\n  src && imageType !== \"img\";\r\n\r\n/**\r\n * Force a value to follow CSS minimum and maximum rules. Note that the minimum\r\n * value can be greater than the maximum value, as implemented by the CSS\r\n * specification.\r\n * The maximum value can be `NaN`. In this case only the minimum value rule\r\n * will be apply.\r\n */\r\nexport const forceCSSMinMax = (\r\n  value: number,\r\n  minimum: number,\r\n  maximum: number\r\n): number =>\r\n  Number.isNaN(maximum)\r\n    ? Math.max(value, minimum)\r\n    : Math.max(Math.min(value, maximum), minimum);\r\n\r\n// - - - - - - - - - - - - - - - - - - - -\r\n//        Cursor and pointer events\r\n// - - - - - - - - - - - - - - - - - - - -\r\nexport const addCursorInDocument = (cursor: CssCursorProperty) => {\r\n  document.documentElement.style.cursor = cursor;\r\n};\r\n\r\nexport const resetCursorInDocument = () => {\r\n  document.documentElement.style.cursor = null;\r\n};\r\n\r\nexport const removePointerEventsInDocumentBody = () => {\r\n  document.body.style.pointerEvents = \"none\";\r\n};\r\n\r\nexport const resetPointerEventsInDocumentBody = () => {\r\n  document.body.style.pointerEvents = null;\r\n};\r\n\r\n// - - - - - - - - - - - - - - - - - - - -\r\n//                RTL utils\r\n// - - - - - - - - - - - - - - - - - - - -\r\nexport const isRTL = () => document.documentElement.dir === \"rtl\";\r\n\r\nlet RTLWatcher: MutationObserver | undefined; // Don't allocate memory until needed\r\nlet RTLSubscribers: Map<string, (rtl: boolean) => void> | undefined; // Don't allocate memory until needed\r\n\r\nconst setRTLWatcher = () => {\r\n  if (RTLWatcher) {\r\n    return;\r\n  }\r\n\r\n  RTLWatcher = new MutationObserver(() => {\r\n    // Defensive programming. Check if there are subscribers\r\n    if (!RTLSubscribers || RTLSubscribers.size === 0) {\r\n      return;\r\n    }\r\n\r\n    const rtlDirection = isRTL();\r\n    const subscribers = [...RTLSubscribers.values()];\r\n\r\n    // Notify all subscribers\r\n    for (let index = 0; index < subscribers.length; index++) {\r\n      const subscriberCallback = subscribers[index];\r\n      subscriberCallback(rtlDirection);\r\n    }\r\n  });\r\n\r\n  // Observe the dir attribute in the document\r\n  RTLWatcher.observe(document.documentElement, {\r\n    attributeFilter: [\"dir\"]\r\n  });\r\n};\r\n\r\nexport const subscribeToRTLChanges = (\r\n  subscriberId: string,\r\n  callback: (rtl: boolean) => void\r\n) => {\r\n  setRTLWatcher();\r\n\r\n  RTLSubscribers ??= new Map();\r\n  RTLSubscribers.set(subscriberId, callback);\r\n};\r\n\r\nexport const unsubscribeToRTLChanges = (subscriberId: string) => {\r\n  RTLSubscribers.delete(subscriberId);\r\n\r\n  // Free the memory if no subscribers remaining\r\n  if (RTLSubscribers.size === 0) {\r\n    RTLWatcher.disconnect();\r\n    RTLWatcher = undefined;\r\n    RTLSubscribers = undefined;\r\n  }\r\n};\r\n"],"mappings":"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"}