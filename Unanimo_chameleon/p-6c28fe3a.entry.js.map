{"version":3,"names":["FIXED_SIZES_SUM_CUSTOM_VAR","DEFAULT_MIN_SIZE","findItemInParent","itemToFind","itemId","item","id","parentItem","items","findIndex","getMousePosition","event","direction","clientX","clientY","getDragBarPosition","dragBarRect","left","top","getFrValue","Number","size","replace","trim","getPxValue","type","value","minSize","hasAbsoluteValue","includes","hasMinSize","getItemMinMaxSizeInTemplate","itemUIModel","actualSize","sizesToGridTemplate","itemsInfo","lastItemIndex","map","index","dragBar","hidden","get","join","getItemFrSize","frValue","frString","fixedOffsetSize","getComponentSize","setPxSize","newValue","newValueString","updatePxSize","increment","setFrSize","updateFrSize","setOffsetSize","itemInfo","incrementOffsetSize","checkAndSetInitialValue","getItemSizeUsingReference","info","itemRef","container","querySelector","clientWidth","clientHeight","checkIfMousePointerIsInsideOfTheValidResizeArea","startItemAvailableIncrement","endItemAvailableIncrement","mouseEvent","undefined","status","getBoundingClientRect","dragBarPosition","mousePosition","mouseIsOutside","RTL","canResizeBothItems","startItemUIModel","endItemUIModel","startItemSizeType","endItemSizeType","incrementInPx","startItemMinSize","startItemSize","availableIncrement","endItemMinSize","endItemSize","fixAndUpdateLayoutModel","layout","fixAndUpdateSubModel","ROOT_VIEW","frSum","fixedSizesSum","length","forEach","adjustedFrValue","group","set","sizeIncrementDictionary","remainingRelativeSizeInPixels","incrementInFr","addSizeIncrementInComponents","actualIncrement","resizeOperationStatus","Math","sign","updateComponentsAndDragBar","gridTemplateDirectionCustomVar","incrementInPxRTL","itemStartId","itemEndId","fixedSizesSumParent","fixedSizesSumRoot","layoutItems","containerSize","mustUpdateTheDOM","style","setProperty","ariaValueText","NO_FIXED_SIZES_TO_UPDATE","removeItem","itemToRemoveUIModel","reconnectedSubtree","fixedSizesSumDecrement","success","itemsToRemove","itemToRemoveIndex","parentItemItems","itemToAddSpaceIndex","itemToAddSpace","push","addSpaceToItemAndGetNewFixesSizes","parentItemUIModel","itemToAddSpaceUIModel","nodeToRemove","nodeToReconnect","subItem","Object","keys","key","delete","itemToRemove","removeElement","itemToSubtractUIModel","itemToAddUIModel","_itemToAddSpaceIsBefore","itemToSubtractInfo","itemToAddInfo","pxValue","itemToAddSpaceOffsetSize","newFrSize","addSiblingLeaf","parentGroup","siblingItem","placedInTheSibling","leafInfo","takeHalfTheSpaceOfTheSiblingItem","parentGroupUIModel","siblingItemUIModel","siblingIndex","leafIndex","parentGroupItems","insertIntoIndex","leafUIModel","siblingHasAbsoluteValue","siblingHalfSize","siblingFixedOffsetSize","fixedSizesSumIncrement","layoutSplitterCss","ChLayoutSplitterStyle0","GRID_TEMPLATE_DIRECTION_CUSTOM_VAR","DIRECTION_CLASS","TEMPLATE_STYLE","getAriaControls","ARROW_UP","ARROW_RIGHT","ARROW_DOWN","ARROW_LEFT","ChLayoutSplitter","dragRAF","mouseDownInfo","lastMousePosition","newMousePosition","Map","modelChanged","newModel","this","updateLayoutInfo","refreshLayout","forceUpdate","result","handleBarDrag","preventDefault","perform","handleBarDragRAF","removeMouseMoveHandler","document","removeEventListener","capture","mouseUpHandler","cancel","resetCursorInDocument","resetPointerEventsInDocumentBody","initializeDragBarValuesForResizeProcessing","target","dragBarContainer","parentElement","isRTL","mouseDownHandler","SyncWithRAF","addCursorInDocument","removePointerEventsInDocumentBody","currentMousePosition","addEventListener","passive","handleResize","code","positiveIncrement","incrementWithKeyboard","renderItem","lastComponentIndex","h","class","part","renderItems","name","role","dragBarDisabled","barAccessibleName","title","tabindex","onKeyDown","onMouseDown","clear","connectedCallback","model","disconnectedCallback","render","layoutModel"],"sources":["src/components/layout-splitter/utils.ts","src/components/layout-splitter/remove-item.ts","src/components/layout-splitter/add-sibling-item.ts","src/components/layout-splitter/layout-splitter.scss?tag=ch-layout-splitter&encapsulation=shadow","src/components/layout-splitter/layout-splitter.tsx"],"sourcesContent":["import { ROOT_VIEW } from \"../../common/utils\";\r\nimport {\r\n  DragBarMouseDownEventInfo,\r\n  GroupExtended,\r\n  ItemExtended,\r\n  LayoutSplitterModel,\r\n  LayoutSplitterGroupModel,\r\n  LayoutSplitterItemModel,\r\n  LayoutSplitterSize\r\n} from \"./types\";\r\n\r\nexport const FIXED_SIZES_SUM_CUSTOM_VAR =\r\n  \"--ch-layout-splitter-fixed-sizes-sum\";\r\n\r\nconst DEFAULT_MIN_SIZE = 0;\r\n\r\nexport const findItemInParent = (itemToFind: ItemExtended): number => {\r\n  const itemId = itemToFind.item.id;\r\n  return itemToFind.parentItem.items.findIndex(item => item.id === itemId);\r\n};\r\n\r\nexport const getMousePosition = (\r\n  event: MouseEvent,\r\n  direction: \"columns\" | \"rows\"\r\n) => (direction === \"columns\" ? event.clientX : event.clientY);\r\n\r\nexport const getDragBarPosition = (\r\n  dragBarRect: DOMRect,\r\n  direction: \"columns\" | \"rows\"\r\n) => (direction === \"columns\" ? dragBarRect.left : dragBarRect.top);\r\n\r\nexport const getFrValue = (item: LayoutSplitterItemModel): number =>\r\n  Number(item.size.replace(\"fr\", \"\").trim());\r\n\r\nexport const getPxValue = (\r\n  item: LayoutSplitterItemModel,\r\n  type: \"size\" | \"min\" = \"size\"\r\n): number => {\r\n  const value = type === \"size\" ? item.size : item.minSize;\r\n  return Number(value.replace(\"px\", \"\").trim());\r\n};\r\n\r\nexport const hasAbsoluteValue = (item: LayoutSplitterItemModel) =>\r\n  item.size.includes(\"px\");\r\n\r\n/**\r\n * `true` if the item has a minimum size that is greater than 0px\r\n */\r\nexport const hasMinSize = (item: LayoutSplitterItemModel) =>\r\n  item.minSize && item.minSize !== \"0px\";\r\n\r\nconst getItemMinMaxSizeInTemplate = (itemUIModel: ItemExtended) =>\r\n  !hasAbsoluteValue(itemUIModel.item) && hasMinSize(itemUIModel.item)\r\n    ? `minmax(${itemUIModel.item.minSize},${itemUIModel.actualSize})`\r\n    : itemUIModel.actualSize;\r\n\r\nexport const sizesToGridTemplate = (\r\n  items: LayoutSplitterItemModel[],\r\n  itemsInfo: Map<string, ItemExtended>,\r\n  lastItemIndex: number\r\n) =>\r\n  items\r\n    .map(\r\n      (item, index) =>\r\n        item.dragBar?.hidden !== true && index !== lastItemIndex\r\n          ? `${getItemMinMaxSizeInTemplate(itemsInfo.get(item.id))} ${\r\n              item.dragBar?.size ?? 0\r\n            }px` // Add a column to place the drag bar\r\n          : getItemMinMaxSizeInTemplate(itemsInfo.get(item.id)) // Last item or not resizable\r\n    )\r\n    .join(\" \");\r\n\r\nconst getItemFrSize = (item: LayoutSplitterItemModel): string => {\r\n  // If the component has fr value, take into account the sum of fixed values\r\n  // to calculate the actual relative value\r\n  const frValue = getFrValue(item);\r\n  const frString = `${frValue * 100}%`;\r\n\r\n  return item.fixedOffsetSize\r\n    ? `calc(${frString} + var(${FIXED_SIZES_SUM_CUSTOM_VAR}) * ${-frValue} + ${\r\n        item.fixedOffsetSize\r\n      }px)`\r\n    : `calc(${frString} + var(${FIXED_SIZES_SUM_CUSTOM_VAR}) * ${-frValue})`;\r\n};\r\n\r\nconst getComponentSize = (item: LayoutSplitterItemModel): string =>\r\n  hasAbsoluteValue(item) // Pixel value\r\n    ? item.size\r\n    : getItemFrSize(item);\r\n\r\nexport const setPxSize = (itemUIModel: ItemExtended, newValue: number) => {\r\n  const newValueString: LayoutSplitterSize = `${newValue}px`;\r\n\r\n  itemUIModel.item.size = newValueString;\r\n  itemUIModel.actualSize = newValueString;\r\n};\r\n\r\nexport const updatePxSize = (itemUIModel: ItemExtended, increment: number) =>\r\n  setPxSize(itemUIModel, getPxValue(itemUIModel.item) + increment);\r\n\r\nexport const setFrSize = (itemUIModel: ItemExtended, newValue: number) => {\r\n  const newValueString: LayoutSplitterSize = `${newValue}fr`;\r\n\r\n  itemUIModel.item.size = newValueString;\r\n  itemUIModel.actualSize = getItemFrSize(itemUIModel.item);\r\n};\r\n\r\nexport const updateFrSize = (itemUIModel: ItemExtended, increment: number) =>\r\n  setFrSize(itemUIModel, getFrValue(itemUIModel.item) + increment);\r\n\r\nexport const setOffsetSize = (itemUIModel: ItemExtended, newValue: number) => {\r\n  const itemInfo = itemUIModel.item;\r\n\r\n  itemInfo.fixedOffsetSize = newValue;\r\n  itemUIModel.actualSize = getComponentSize(itemInfo);\r\n};\r\n\r\nexport const incrementOffsetSize = (\r\n  itemUIModel: ItemExtended,\r\n  increment: number\r\n) =>\r\n  setOffsetSize(\r\n    itemUIModel,\r\n    increment + (itemUIModel.item.fixedOffsetSize ?? 0)\r\n  );\r\n\r\n/**\r\n * If the item has `minSize` and its greater that the `size` value, it updates\r\n * the `size` to be equal to the `minSize`.\r\n */\r\nconst checkAndSetInitialValue = (item: LayoutSplitterItemModel) => {\r\n  if (hasMinSize(item) && getPxValue(item) < getPxValue(item, \"min\")) {\r\n    item.size = item.minSize;\r\n  }\r\n};\r\n\r\nconst getItemSizeUsingReference = (\r\n  info: DragBarMouseDownEventInfo,\r\n  itemUIModel: ItemExtended\r\n): number => {\r\n  const itemRef = info.container.querySelector(`[id=\"${itemUIModel.item.id}\"]`);\r\n  return info.direction === \"columns\"\r\n    ? itemRef.clientWidth\r\n    : itemRef.clientHeight;\r\n};\r\n\r\nconst checkIfMousePointerIsInsideOfTheValidResizeArea = (\r\n  startItemAvailableIncrement: number,\r\n  endItemAvailableIncrement: number,\r\n  info: DragBarMouseDownEventInfo\r\n): {\r\n  status: \"ok\" | \"deny\";\r\n} => {\r\n  // The resize operation was performed using the keyboard or the items does not\r\n  // have a minimum size. Nothing to check\r\n  if (info.mouseEvent === undefined) {\r\n    return { status: \"ok\" };\r\n  }\r\n\r\n  const dragBarRect = info.dragBar.getBoundingClientRect();\r\n  const dragBarPosition = getDragBarPosition(dragBarRect, info.direction);\r\n  const mousePosition = getMousePosition(info.mouseEvent, info.direction);\r\n\r\n  // If start item is its minimum position and the mouse is outside of the\r\n  // valid area\r\n  if (startItemAvailableIncrement === 0) {\r\n    const mouseIsOutside =\r\n      info.direction === \"columns\" && info.RTL\r\n        ? mousePosition > dragBarPosition\r\n        : mousePosition < dragBarPosition;\r\n\r\n    if (mouseIsOutside) {\r\n      return {\r\n        status: \"deny\"\r\n      };\r\n    }\r\n  }\r\n  // Check the same for the end item\r\n  if (endItemAvailableIncrement === 0) {\r\n    const mouseIsOutside =\r\n      info.direction === \"columns\" && info.RTL\r\n        ? mousePosition < dragBarPosition\r\n        : mousePosition > dragBarPosition;\r\n\r\n    if (mouseIsOutside) {\r\n      return {\r\n        status: \"deny\"\r\n      };\r\n    }\r\n  }\r\n\r\n  return { status: \"ok\" };\r\n};\r\n\r\n/**\r\n * Given the two items to resize and its increment (`incrementInPx`), return if\r\n * both items can be resized or the resize operation must be adjusted or\r\n * canceled.\r\n */\r\nconst canResizeBothItems = (\r\n  startItemUIModel: ItemExtended,\r\n  endItemUIModel: ItemExtended,\r\n  startItemSizeType: \"px\" | \"fr\",\r\n  endItemSizeType: \"px\" | \"fr\",\r\n  incrementInPx: number,\r\n  info: DragBarMouseDownEventInfo\r\n): {\r\n  status: \"ok\" | \"deny\" | \"not-enough-space\";\r\n  availableIncrement?: number;\r\n} => {\r\n  // - - - - - - - - - - - - - - - -\r\n  //           Start item\r\n  // - - - - - - - - - - - - - - - -\r\n  const startItemMinSize = hasMinSize(startItemUIModel.item)\r\n    ? getPxValue(startItemUIModel.item, \"min\")\r\n    : DEFAULT_MIN_SIZE;\r\n  const startItemSize =\r\n    startItemSizeType === \"px\"\r\n      ? getPxValue(startItemUIModel.item)\r\n      : getItemSizeUsingReference(info, startItemUIModel);\r\n\r\n  const startItemAvailableIncrement = startItemSize - startItemMinSize;\r\n\r\n  // It means the startItem must be shrunk, but it does not have enough space\r\n  if (startItemAvailableIncrement + incrementInPx <= 0) {\r\n    return {\r\n      status: startItemAvailableIncrement === 0 ? \"deny\" : \"not-enough-space\",\r\n      availableIncrement: startItemAvailableIncrement\r\n    };\r\n  }\r\n\r\n  // - - - - - - - - - - - - - - - -\r\n  //            End item\r\n  // - - - - - - - - - - - - - - - -\r\n  const endItemMinSize = hasMinSize(endItemUIModel.item)\r\n    ? getPxValue(endItemUIModel.item, \"min\")\r\n    : DEFAULT_MIN_SIZE;\r\n  const endItemSize =\r\n    endItemSizeType === \"px\"\r\n      ? getPxValue(endItemUIModel.item)\r\n      : getItemSizeUsingReference(info, endItemUIModel);\r\n\r\n  const endItemAvailableIncrement = endItemSize - endItemMinSize;\r\n\r\n  // It means the endItem must be shrunk, but it does not have enough space\r\n  if (endItemAvailableIncrement - incrementInPx <= 0) {\r\n    return {\r\n      status: endItemAvailableIncrement === 0 ? \"deny\" : \"not-enough-space\",\r\n      availableIncrement: endItemAvailableIncrement\r\n    };\r\n  }\r\n\r\n  // In this instance, the drag operation is not modified, but we still don't\r\n  // know the position of the mouse. If one of the items is in its minimum size\r\n  // and the operation will increase one of its sizes, the mouse pointer must\r\n  // not be out of the valid area\r\n  return checkIfMousePointerIsInsideOfTheValidResizeArea(\r\n    startItemAvailableIncrement,\r\n    endItemAvailableIncrement,\r\n    info\r\n  );\r\n};\r\n\r\nexport const fixAndUpdateLayoutModel = (\r\n  layout: LayoutSplitterModel,\r\n  itemsInfo: Map<string, ItemExtended>\r\n): number => fixAndUpdateSubModel(layout.items, itemsInfo, ROOT_VIEW);\r\n\r\nfunction fixAndUpdateSubModel(\r\n  items: LayoutSplitterItemModel[],\r\n  itemsInfo: Map<string, ItemExtended>,\r\n  parentItem: LayoutSplitterGroupModel\r\n): number {\r\n  let frSum = 0;\r\n  let fixedSizesSum = 0;\r\n\r\n  const lastItemIndex = items.length - 1;\r\n\r\n  // Get the sum of all fr values. Also, store the sum of fixed sizes\r\n  items.forEach((item, index) => {\r\n    if (hasAbsoluteValue(item)) {\r\n      checkAndSetInitialValue(item);\r\n\r\n      fixedSizesSum += getPxValue(item);\r\n    } else {\r\n      frSum += getFrValue(item);\r\n    }\r\n\r\n    // Take into account previous resizes (fixedOffsetSize values) and add drag\r\n    // bar sizes if this is not the last item\r\n    fixedSizesSum +=\r\n      (item.fixedOffsetSize ?? 0) +\r\n      (index !== lastItemIndex ? item.dragBar?.size ?? 0 : 0);\r\n  });\r\n\r\n  // If there are fr values, we must adjust the frs values to be relative to 1fr\r\n  if (frSum > 0) {\r\n    items.forEach(item => {\r\n      if (!hasAbsoluteValue(item)) {\r\n        const frValue = getFrValue(item);\r\n        const adjustedFrValue = frValue / frSum;\r\n\r\n        item.size = `${adjustedFrValue}fr`;\r\n      }\r\n    });\r\n  }\r\n\r\n  // Update the actualSizes and fixedSizes maps\r\n  items.forEach(item => {\r\n    const itemUIModel: ItemExtended = {\r\n      item: item,\r\n      parentItem: parentItem,\r\n      actualSize: getComponentSize(item)\r\n    };\r\n\r\n    if ((item as LayoutSplitterGroupModel).items != null) {\r\n      const group = item as LayoutSplitterGroupModel;\r\n      const fixedSizesSum = fixAndUpdateSubModel(group.items, itemsInfo, group);\r\n\r\n      (itemUIModel as GroupExtended).fixedSizesSum = fixedSizesSum;\r\n    }\r\n\r\n    itemsInfo.set(item.id, itemUIModel);\r\n  });\r\n\r\n  return fixedSizesSum;\r\n}\r\n\r\nconst sizeIncrementDictionary: {\r\n  [key in \"px-px\" | \"px-fr\" | \"fr-px\" | \"fr-fr\"]: (\r\n    startItemUIModel: ItemExtended,\r\n    endItemUIModel: ItemExtended,\r\n    incrementInPx: number,\r\n    remainingRelativeSizeInPixels: number\r\n  ) => void;\r\n} = {\r\n  \"px-px\": (startItemUIModel, endItemUIModel, incrementInPx) => {\r\n    updatePxSize(startItemUIModel, incrementInPx);\r\n    updatePxSize(endItemUIModel, -incrementInPx);\r\n  },\r\n\r\n  \"px-fr\": (startItemUIModel, endItemUIModel, incrementInPx) => {\r\n    updatePxSize(startItemUIModel, incrementInPx);\r\n    incrementOffsetSize(endItemUIModel, -incrementInPx);\r\n  },\r\n\r\n  \"fr-px\": (startItemUIModel, endItemUIModel, incrementInPx) => {\r\n    incrementOffsetSize(startItemUIModel, incrementInPx);\r\n    updatePxSize(endItemUIModel, -incrementInPx);\r\n  },\r\n\r\n  \"fr-fr\": (\r\n    startItemUIModel,\r\n    endItemUIModel,\r\n    incrementInPx,\r\n    remainingRelativeSizeInPixels\r\n  ) => {\r\n    const incrementInFr = incrementInPx / remainingRelativeSizeInPixels;\r\n    updateFrSize(startItemUIModel, incrementInFr);\r\n    updateFrSize(endItemUIModel, -incrementInFr);\r\n  }\r\n};\r\n\r\nconst addSizeIncrementInComponents = (\r\n  startItemUIModel: ItemExtended,\r\n  endItemUIModel: ItemExtended,\r\n  incrementInPx: number,\r\n  remainingRelativeSizeInPixels: number,\r\n  info: DragBarMouseDownEventInfo\r\n): boolean => {\r\n  const startItemSizeType = hasAbsoluteValue(startItemUIModel.item)\r\n    ? \"px\"\r\n    : \"fr\";\r\n  const endItemSizeType = hasAbsoluteValue(endItemUIModel.item) ? \"px\" : \"fr\";\r\n  let actualIncrement = incrementInPx;\r\n\r\n  const resizeOperationStatus = canResizeBothItems(\r\n    startItemUIModel,\r\n    endItemUIModel,\r\n    startItemSizeType,\r\n    endItemSizeType,\r\n    incrementInPx,\r\n    info\r\n  );\r\n\r\n  if (resizeOperationStatus.status === \"deny\") {\r\n    return false;\r\n  }\r\n  if (resizeOperationStatus.status === \"not-enough-space\") {\r\n    actualIncrement =\r\n      resizeOperationStatus.availableIncrement * Math.sign(actualIncrement);\r\n  }\r\n\r\n  sizeIncrementDictionary[`${startItemSizeType}-${endItemSizeType}`](\r\n    startItemUIModel,\r\n    endItemUIModel,\r\n    actualIncrement,\r\n    remainingRelativeSizeInPixels\r\n  );\r\n\r\n  return true;\r\n};\r\n\r\nexport const updateComponentsAndDragBar = (\r\n  info: DragBarMouseDownEventInfo,\r\n  itemsInfo: Map<string, ItemExtended>,\r\n  incrementInPx: number,\r\n  gridTemplateDirectionCustomVar: string\r\n) => {\r\n  // - - - - - - - - - Increments - - - - - - - - -\r\n  // When the language is RTL, the increment is in the opposite direction\r\n  const incrementInPxRTL =\r\n    info.direction === \"columns\" && info.RTL ? -incrementInPx : incrementInPx;\r\n\r\n  // Components at each position of the drag bar\r\n  const startItemUIModel = itemsInfo.get(info.itemStartId);\r\n  const endItemUIModel = itemsInfo.get(info.itemEndId);\r\n\r\n  const fixedSizesSumParent =\r\n    startItemUIModel.parentItem === ROOT_VIEW\r\n      ? info.fixedSizesSumRoot\r\n      : (itemsInfo.get(startItemUIModel.parentItem.id) as GroupExtended)\r\n          .fixedSizesSum;\r\n\r\n  const layoutItems = info.layoutItems;\r\n\r\n  const remainingRelativeSizeInPixels =\r\n    info.containerSize - fixedSizesSumParent;\r\n\r\n  const mustUpdateTheDOM = addSizeIncrementInComponents(\r\n    startItemUIModel,\r\n    endItemUIModel,\r\n    incrementInPxRTL,\r\n    remainingRelativeSizeInPixels,\r\n    info\r\n  );\r\n\r\n  // No resizing can be done, so there is no need to update the DOM\r\n  if (!mustUpdateTheDOM) {\r\n    return;\r\n  }\r\n\r\n  // Update in the DOM the grid distribution\r\n  info.container.style.setProperty(\r\n    gridTemplateDirectionCustomVar,\r\n    sizesToGridTemplate(layoutItems, itemsInfo, layoutItems.length - 1)\r\n  );\r\n\r\n  // Update the current value in the drag bar\r\n  info.dragBar.ariaValueText = startItemUIModel.actualSize;\r\n};\r\n","import { removeElement } from \"../../common/array\";\r\nimport {\r\n  GroupExtended,\r\n  ItemExtended,\r\n  LayoutSplitterGroupModel,\r\n  LayoutSplitterItemModel,\r\n  LayoutSplitterItemRemoveResult,\r\n  LayoutSplitterReconnectedSubtree\r\n} from \"./types\";\r\nimport {\r\n  getFrValue,\r\n  getPxValue,\r\n  hasAbsoluteValue,\r\n  incrementOffsetSize,\r\n  updatePxSize,\r\n  findItemInParent,\r\n  setFrSize\r\n} from \"./utils\";\r\n\r\n/**\r\n * [parentArray, indexToRemove, idOfTheItem]\r\n */\r\ntype ItemToRemove = [LayoutSplitterItemModel[], number, string];\r\n\r\nexport const NO_FIXED_SIZES_TO_UPDATE = 0;\r\n\r\nexport const removeItem = (\r\n  itemId: string,\r\n  itemsInfo: Map<string, ItemExtended>\r\n): LayoutSplitterItemRemoveResult => {\r\n  const itemToRemoveUIModel = itemsInfo.get(itemId);\r\n  let reconnectedSubtree: LayoutSplitterReconnectedSubtree = undefined;\r\n  let fixedSizesSumDecrement: number = NO_FIXED_SIZES_TO_UPDATE;\r\n\r\n  if (!itemToRemoveUIModel) {\r\n    return {\r\n      success: false,\r\n      reconnectedSubtree: reconnectedSubtree,\r\n      fixedSizesSumDecrement: fixedSizesSumDecrement\r\n    };\r\n  }\r\n\r\n  // TODO: Valid whether the parent is the root node or not. If it is the root, update the fixedSizesSum\r\n\r\n  const itemsToRemove: ItemToRemove[] = [];\r\n\r\n  const itemToRemoveIndex = findItemInParent(itemToRemoveUIModel);\r\n  const parentItem = itemToRemoveUIModel.parentItem;\r\n  const parentItemItems = parentItem.items;\r\n\r\n  const itemToAddSpaceIndex =\r\n    itemToRemoveIndex === 0 ? 1 : itemToRemoveIndex - 1;\r\n  const itemToAddSpace = parentItemItems[itemToAddSpaceIndex];\r\n\r\n  // Queue to remove the item in a future iteration\r\n  itemsToRemove.push([parentItemItems, itemToRemoveIndex, itemId]);\r\n\r\n  // The space reserved for the item can be given to a sibling item\r\n  if (parentItemItems.length > 2) {\r\n    fixedSizesSumDecrement = addSpaceToItemAndGetNewFixesSizes(\r\n      itemToRemoveUIModel,\r\n      itemsInfo.get(itemToAddSpace.id),\r\n      itemToAddSpaceIndex < itemToRemoveIndex\r\n    );\r\n\r\n    // TODO: CHECK WHAT HAPPENS WITH THE DRAG BAR SIZE OF THE REMOVED ITEM IN THE fixedSizesSumDecrement <----------------\r\n  }\r\n\r\n  // The current group will have one child. Remove the group and and reconnect\r\n  // the child item with the parent of its group\r\n  else if (parentItemItems.length === 2) {\r\n    // - - - - - - - - - - - - - - - - - - - - - - - - -\r\n    // INPUT MODEL:\r\n    //                     secondParentItem\r\n    //                            / \\\r\n    //                         /       \\\r\n    //                      /             \\\r\n    //            (Id x) parentItem   Other items...\r\n    //                     / \\\r\n    //                  /       \\\r\n    //               /             \\\r\n    //  (Id y) itemToRemove   (Id z) itemToAddSpace\r\n    //                                    / \\\r\n    //                                 /       \\\r\n    //                                 groups...\r\n    //\r\n    //\r\n    // OUTPUT MODEL:\r\n    //                secondParentItem\r\n    //                       / \\\r\n    //                    /       \\\r\n    //                 /             \\\r\n    //     (Id x) parentItem    Other items...\r\n    //              / \\\r\n    //           /       \\\r\n    //           groups...\r\n    // - - - - - - - - - - - - - - - - - - - - - - - - -\r\n\r\n    // TODO: CHECK PARENT ROOT <-----------------------------------------------------\r\n    const parentItemUIModel = itemsInfo.get(parentItem.id) as GroupExtended;\r\n    const itemToAddSpaceUIModel = itemsInfo.get(\r\n      itemToAddSpace.id\r\n    ) as GroupExtended;\r\n\r\n    // Push the item rename\r\n    reconnectedSubtree = {\r\n      nodeToRemove: itemToAddSpace.id,\r\n      nodeToReconnect: parentItem.id\r\n    };\r\n\r\n    // Reconnect the parent for the \"itemToAddSpace\" items\r\n    if ((itemToAddSpace as LayoutSplitterGroupModel).items != null) {\r\n      (itemToAddSpace as LayoutSplitterGroupModel).items.forEach(subItem => {\r\n        itemsInfo.get(subItem.id).parentItem = parentItem;\r\n      });\r\n    }\r\n\r\n    // Update the fixedSizesSum even if it does not exists in the \"itemToAddSpace\"\r\n    parentItemUIModel.fixedSizesSum = itemToAddSpaceUIModel.fixedSizesSum;\r\n\r\n    // This property is no longer valid in the new parent\r\n    delete parentItem.items;\r\n\r\n    // Update all properties in the new parent, except for some specific properties\r\n    Object.keys(itemToAddSpace).forEach(\r\n      (key: keyof LayoutSplitterItemModel) => {\r\n        if (\r\n          key !== \"id\" &&\r\n          key !== \"size\" &&\r\n          key !== \"dragBar\" &&\r\n          key !== \"fixedOffsetSize\"\r\n        ) {\r\n          parentItem[key] = itemToAddSpace[key];\r\n        }\r\n      }\r\n    );\r\n\r\n    itemsInfo.delete(itemToAddSpace.id);\r\n  } else {\r\n    // Remove the item and its group parent\r\n  }\r\n\r\n  // Delete the item and all its descendants...\r\n  // TODO: Add recursive removal\r\n\r\n  itemsToRemove.forEach(itemToRemove => {\r\n    removeElement(itemToRemove[0], itemToRemove[1]);\r\n    itemsInfo.delete(itemToRemove[2]);\r\n  });\r\n\r\n  // TODO: Remove the dragBar parts that no longer apply???? <----------------------\r\n\r\n  return {\r\n    success: true,\r\n    reconnectedSubtree: reconnectedSubtree,\r\n    fixedSizesSumDecrement: fixedSizesSumDecrement\r\n  };\r\n};\r\n\r\nfunction addSpaceToItemAndGetNewFixesSizes(\r\n  itemToSubtractUIModel: ItemExtended,\r\n  itemToAddUIModel: ItemExtended,\r\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n  _itemToAddSpaceIsBefore: boolean\r\n): number {\r\n  // TODO: Add implementation. Ensure the given space is relative to 100% (1fr)\r\n  // TODO: Remove drag bar Size from fixedSizesSum\r\n\r\n  const itemToSubtractInfo = itemToSubtractUIModel.item;\r\n  const itemToAddInfo = itemToAddUIModel.item;\r\n\r\n  // px / px\r\n  if (hasAbsoluteValue(itemToSubtractInfo) && hasAbsoluteValue(itemToAddInfo)) {\r\n    updatePxSize(itemToAddUIModel, getPxValue(itemToSubtractInfo));\r\n    return NO_FIXED_SIZES_TO_UPDATE;\r\n  }\r\n\r\n  // itemToSubtract ----> px / itemToAdd ---> fr\r\n  if (hasAbsoluteValue(itemToSubtractInfo)) {\r\n    const pxValue = getPxValue(itemToSubtractInfo);\r\n    let fixedSizesSumDecrement = pxValue;\r\n\r\n    const itemToAddSpaceOffsetSize = itemToAddInfo.fixedOffsetSize;\r\n\r\n    // It means we must reset the fixedOffsetSize value, since it could be set\r\n    // by any resize that has occurred\r\n    if (itemToAddSpaceOffsetSize != null) {\r\n      // Remove the space that the resize introduced\r\n      fixedSizesSumDecrement += itemToAddSpaceOffsetSize;\r\n\r\n      incrementOffsetSize(itemToAddUIModel, -itemToAddSpaceOffsetSize);\r\n    }\r\n\r\n    return fixedSizesSumDecrement;\r\n  }\r\n\r\n  // itemToSubtract ----> fr / itemToAdd ---> px\r\n  if (hasAbsoluteValue(itemToAddInfo)) {\r\n    // updateOffsetSize(startItemUIModel, incrementInPxRTL, fixedSizes);\r\n    // updateSize(endItemUIModel, -incrementInPxRTL, fixedSizes, \"px\");\r\n\r\n    // const pxValue = getPxValue(itemToSubtractInfo);\r\n    // let fixedSizesSumDecrement = pxValue;\r\n\r\n    // // It means we must reset the fixedOffsetSize value, since it could be set\r\n    // // by any resize that has occurred\r\n    // if (itemToAddSpaceIsBefore) {\r\n    //   fixedSizesSumDecrement -= itemToAddInfo.fixedOffsetSize ?? 0;\r\n\r\n    //   updateOffsetSize(itemToAddUIModel, 0);\r\n    // }\r\n\r\n    return NO_FIXED_SIZES_TO_UPDATE;\r\n  }\r\n  // fr / fr\r\n\r\n  // Update fixedOffsetSize if the removed item had\r\n  if (itemToSubtractInfo.fixedOffsetSize != null) {\r\n    incrementOffsetSize(\r\n      itemToSubtractUIModel,\r\n      itemToSubtractInfo.fixedOffsetSize\r\n    );\r\n  }\r\n\r\n  const newFrSize = getFrValue(itemToSubtractInfo) + getFrValue(itemToAddInfo);\r\n  setFrSize(itemToAddUIModel, newFrSize);\r\n\r\n  return NO_FIXED_SIZES_TO_UPDATE;\r\n}\r\n","import { insertIntoIndex } from \"../../common/array\";\r\nimport {\r\n  GroupExtended,\r\n  ItemExtended,\r\n  LayoutSplitterLeafModel,\r\n  LayoutSplitterItemAddResult,\r\n  LeafExtended\r\n} from \"./types\";\r\nimport {\r\n  findItemInParent,\r\n  getFrValue,\r\n  getPxValue,\r\n  hasAbsoluteValue,\r\n  setFrSize,\r\n  setOffsetSize,\r\n  setPxSize\r\n} from \"./utils\";\r\n\r\n/**\r\n *\r\n * @param parentGroup\r\n * @param siblingItem\r\n * @param placedInTheSibling\r\n * @param leafInfo\r\n * @param itemsInfo\r\n * @param takeHalfTheSpaceOfTheSiblingItem\r\n *   When `true` the `fixedOffsetSize` and size member of the leaf will be\r\n *   ignored. Those members will be deduced from the sibling item as the half\r\n *   value of each one.\r\n * @returns\r\n */\r\nexport const addSiblingLeaf = (\r\n  parentGroup: string,\r\n  siblingItem: string,\r\n  placedInTheSibling: \"before\" | \"after\",\r\n  leafInfo: LayoutSplitterLeafModel,\r\n  itemsInfo: Map<string, ItemExtended>,\r\n  takeHalfTheSpaceOfTheSiblingItem: boolean\r\n): LayoutSplitterItemAddResult => {\r\n  // TODO: Add support for adding in the root node <----------------------\r\n\r\n  const parentGroupUIModel = itemsInfo.get(parentGroup) as\r\n    | GroupExtended\r\n    | undefined;\r\n  if (!parentGroupUIModel) {\r\n    return { success: false };\r\n  }\r\n\r\n  const siblingItemUIModel = itemsInfo.get(siblingItem);\r\n  if (!siblingItemUIModel) {\r\n    return { success: false };\r\n  }\r\n\r\n  // Get the index of the leaf\r\n  const siblingIndex = findItemInParent(siblingItemUIModel);\r\n  const leafIndex =\r\n    placedInTheSibling === \"before\" ? siblingIndex : siblingIndex + 1;\r\n\r\n  const parentGroupItems = parentGroupUIModel.item.items;\r\n\r\n  // Set the leaf index. Last index case\r\n  if (leafIndex === parentGroupItems.length) {\r\n    parentGroupItems.push(leafInfo);\r\n  }\r\n  // 0 <= leafIndex < totalItems\r\n  else {\r\n    insertIntoIndex(parentGroupItems, leafInfo, leafIndex);\r\n  }\r\n\r\n  const leafUIModel: LeafExtended = {\r\n    item: leafInfo,\r\n    parentItem: parentGroupUIModel.item,\r\n    actualSize: undefined\r\n  };\r\n\r\n  // Update the size of the leaf and its sibling. Each one will have half of\r\n  // the sibling size\r\n  if (takeHalfTheSpaceOfTheSiblingItem) {\r\n    const siblingHasAbsoluteValue = hasAbsoluteValue(siblingItemUIModel.item);\r\n\r\n    const siblingHalfSize =\r\n      (siblingHasAbsoluteValue\r\n        ? getPxValue(siblingItemUIModel.item)\r\n        : getFrValue(siblingItemUIModel.item)) / 2;\r\n\r\n    // Absolute value. Update the size member\r\n    if (siblingHasAbsoluteValue) {\r\n      setPxSize(leafUIModel, siblingHalfSize);\r\n      setPxSize(siblingItemUIModel, siblingHalfSize);\r\n    }\r\n    // Relative value. Update the size and fixedOffsetSize members\r\n    else {\r\n      const siblingFixedOffsetSize = siblingItemUIModel.item.fixedOffsetSize;\r\n\r\n      // Set the fixedOffsetSize if the sibling has\r\n      if (siblingFixedOffsetSize) {\r\n        setOffsetSize(leafUIModel, siblingFixedOffsetSize / 2);\r\n        setOffsetSize(siblingItemUIModel, siblingFixedOffsetSize / 2);\r\n      }\r\n\r\n      setFrSize(leafUIModel, siblingHalfSize);\r\n      setFrSize(siblingItemUIModel, siblingHalfSize);\r\n    }\r\n  } else {\r\n    // TODO: Add implementation\r\n  }\r\n\r\n  // TODO: Emit the new dragBar parts <----------------------\r\n\r\n  // Add the leaf to the itemsInfo Map\r\n  itemsInfo.set(leafInfo.id, leafUIModel);\r\n\r\n  return { success: true, fixedSizesSumIncrement: leafInfo.dragBar?.size };\r\n};\r\n","@import \"../../common/base\";\r\n\r\n@include box-sizing();\r\n\r\n:host {\r\n  --ch-drag-bar__size: 5px;\r\n\r\n  display: grid;\r\n  position: relative;\r\n  block-size: 100%;\r\n  inline-size: 100%;\r\n}\r\n\r\n// - - - - - - - - - - - - - - - -\r\n//               Bar\r\n// - - - - - - - - - - - - - - - -\r\n.bar {\r\n  --position-fix: calc((var(--size, 0px) - var(--ch-drag-bar__size)) / 2);\r\n  position: relative;\r\n  inline-size: 100%;\r\n  block-size: 100%;\r\n  background-color: currentColor;\r\n  z-index: 1;\r\n\r\n  &[aria-disabled] {\r\n    pointer-events: none;\r\n  }\r\n\r\n  // Remove default focus style\r\n  &:focus-visible {\r\n    outline: unset;\r\n  }\r\n\r\n  &::after {\r\n    content: \"\";\r\n    display: flex;\r\n    position: absolute;\r\n    background-color: currentColor;\r\n    opacity: 0;\r\n\r\n    transition: opacity 0s linear;\r\n  }\r\n\r\n  &:is(:active, :focus-visible, :hover)::after {\r\n    opacity: 1;\r\n  }\r\n\r\n  &:hover::after {\r\n    transition-delay: 250ms; // Hovering delays the display of the drag-bar\r\n  }\r\n}\r\n\r\n// - - - - - - - - - - - - - - - -\r\n//           Containers\r\n// - - - - - - - - - - - - - - - -\r\n.leaf {\r\n  // Leafs must always take space to calculate if their size is greater that\r\n  // zero, since all items have a minimum size of zero if the minSize is not set\r\n  display: grid;\r\n}\r\n\r\n.group {\r\n  display: grid;\r\n  position: relative;\r\n}\r\n\r\n.direction--columns {\r\n  grid-template-columns: var(--ch-layout-splitter__distribution);\r\n\r\n  & > .bar {\r\n    cursor: ew-resize;\r\n\r\n    &::after {\r\n      block-size: 100%;\r\n      inline-size: var(--ch-drag-bar__size);\r\n      margin-inline-start: var(--position-fix);\r\n    }\r\n  }\r\n}\r\n\r\n.direction--rows {\r\n  grid-template-rows: var(--ch-layout-splitter__distribution);\r\n\r\n  & > .bar {\r\n    cursor: ns-resize;\r\n\r\n    &::after {\r\n      block-size: var(--ch-drag-bar__size);\r\n      inline-size: 100%;\r\n      margin-block-start: var(--position-fix);\r\n    }\r\n  }\r\n}\r\n","import {\r\n  Component,\r\n  Element,\r\n  Method,\r\n  Prop,\r\n  Watch,\r\n  forceUpdate,\r\n  h\r\n} from \"@stencil/core\";\r\nimport { Component as ChComponent } from \"../../common/interfaces\";\r\nimport {\r\n  DragBarMouseDownEventInfo,\r\n  GroupExtended,\r\n  ItemExtended,\r\n  LayoutSplitterDirection,\r\n  LayoutSplitterModel,\r\n  LayoutSplitterGroupModel,\r\n  LayoutSplitterItemModel,\r\n  LayoutSplitterLeafModel,\r\n  LayoutSplitterItemAddResult,\r\n  LayoutSplitterItemRemoveResult\r\n} from \"./types\";\r\nimport {\r\n  FIXED_SIZES_SUM_CUSTOM_VAR,\r\n  fixAndUpdateLayoutModel,\r\n  getMousePosition,\r\n  sizesToGridTemplate,\r\n  updateComponentsAndDragBar\r\n} from \"./utils\";\r\nimport {\r\n  ROOT_VIEW,\r\n  addCursorInDocument,\r\n  isRTL,\r\n  removePointerEventsInDocumentBody,\r\n  resetCursorInDocument,\r\n  resetPointerEventsInDocumentBody\r\n} from \"../../common/utils\";\r\nimport { NO_FIXED_SIZES_TO_UPDATE, removeItem } from \"./remove-item\";\r\nimport { addSiblingLeaf } from \"./add-sibling-item\";\r\nimport { SyncWithRAF } from \"../../common/sync-with-frames\";\r\n\r\ntype Group = LayoutSplitterGroupModel;\r\ntype Item = LayoutSplitterItemModel;\r\n\r\nconst GRID_TEMPLATE_DIRECTION_CUSTOM_VAR = \"--ch-layout-splitter__distribution\";\r\n\r\nconst DIRECTION_CLASS = (direction: LayoutSplitterDirection) =>\r\n  `group direction--${direction}`;\r\n\r\nconst TEMPLATE_STYLE = (\r\n  items: Item[],\r\n  itemsInfo: Map<string, ItemExtended>,\r\n  fixedSizesSum: number\r\n) => ({\r\n  [GRID_TEMPLATE_DIRECTION_CUSTOM_VAR]: sizesToGridTemplate(\r\n    items,\r\n    itemsInfo,\r\n    items.length - 1\r\n  ),\r\n  [FIXED_SIZES_SUM_CUSTOM_VAR]: `${fixedSizesSum}px`\r\n});\r\n\r\nconst getAriaControls = (layoutItems: Item[], index: number) =>\r\n  `${layoutItems[index].id} ${layoutItems[index + 1].id}`;\r\n\r\n// Key codes\r\nconst ARROW_UP = \"ArrowUp\";\r\nconst ARROW_RIGHT = \"ArrowRight\";\r\nconst ARROW_DOWN = \"ArrowDown\";\r\nconst ARROW_LEFT = \"ArrowLeft\";\r\n\r\n/**\r\n * @part bar - The bar that divides two columns or two rows\r\n */\r\n@Component({\r\n  shadow: true,\r\n  styleUrl: \"layout-splitter.scss\",\r\n  tag: \"ch-layout-splitter\"\r\n})\r\nexport class ChLayoutSplitter implements ChComponent {\r\n  // Sync computations with frames\r\n  #dragRAF: SyncWithRAF; // Don't allocate memory until needed when dragging\r\n\r\n  #mouseDownInfo: DragBarMouseDownEventInfo;\r\n  #lastMousePosition: number;\r\n  #newMousePosition: number;\r\n\r\n  #fixedSizesSumRoot: number;\r\n\r\n  // Distribution of elements\r\n  #itemsInfo: Map<string, ItemExtended> = new Map();\r\n\r\n  @Element() el: HTMLChLayoutSplitterElement;\r\n\r\n  /**\r\n   * This attribute lets you specify the label for the drag bar.\r\n   * Important for accessibility.\r\n   */\r\n  @Prop() readonly barAccessibleName: string = \"Resize\";\r\n\r\n  /**\r\n   * This attribute lets you specify if the resize operation is disabled in all\r\n   * drag bars. If `true`, the drag bars are disabled.\r\n   */\r\n  @Prop() readonly dragBarDisabled: boolean = false;\r\n\r\n  /**\r\n   * Specifies the resizing increment (in pixel) that is applied when using the\r\n   * keyboard to resize a drag bar.\r\n   */\r\n  @Prop() readonly incrementWithKeyboard: number = 2;\r\n\r\n  /**\r\n   * Specifies the list of component that are displayed. Each component will be\r\n   * separated via a drag bar.\r\n   */\r\n  @Prop() readonly model: LayoutSplitterModel = {\r\n    id: \"root\",\r\n    direction: \"columns\",\r\n    items: []\r\n  };\r\n  @Watch(\"model\")\r\n  modelChanged(newModel: LayoutSplitterModel) {\r\n    this.#updateLayoutInfo(newModel);\r\n  }\r\n\r\n  /**\r\n   * Schedules a new render of the control even if no state changed.\r\n   */\r\n  @Method()\r\n  async refreshLayout() {\r\n    forceUpdate(this);\r\n  }\r\n\r\n  /**\r\n   *\r\n   */\r\n  @Method()\r\n  async addSiblingLeaf(\r\n    parentGroup: string,\r\n    siblingItem: string,\r\n    placedInTheSibling: \"before\" | \"after\",\r\n    leafInfo: LayoutSplitterLeafModel,\r\n    takeHalfTheSpaceOfTheSiblingItem: boolean\r\n  ): Promise<LayoutSplitterItemAddResult> {\r\n    const result = addSiblingLeaf(\r\n      parentGroup,\r\n      siblingItem,\r\n      placedInTheSibling,\r\n      leafInfo,\r\n      this.#itemsInfo,\r\n      takeHalfTheSpaceOfTheSiblingItem\r\n    );\r\n\r\n    if (result.success) {\r\n      const fixedSizesSumIncrement = result.fixedSizesSumIncrement;\r\n\r\n      // The fixesSizesSum of the parent must be updated\r\n      if (fixedSizesSumIncrement) {\r\n        const parentItem = this.#itemsInfo.get(parentGroup).parentItem;\r\n\r\n        if (parentItem === ROOT_VIEW) {\r\n          this.#fixedSizesSumRoot += fixedSizesSumIncrement;\r\n        } else {\r\n          (this.#itemsInfo.get(parentItem.id) as GroupExtended).fixedSizesSum +=\r\n            fixedSizesSumIncrement;\r\n        }\r\n      }\r\n\r\n      // Queue re-renders\r\n      forceUpdate(this);\r\n    }\r\n\r\n    return result;\r\n  }\r\n\r\n  /**\r\n   * Removes the item that is identified by the given ID.\r\n   * The layout is rearranged depending on the state of the removed item.\r\n   */\r\n  @Method()\r\n  async removeItem(itemId: string): Promise<LayoutSplitterItemRemoveResult> {\r\n    const parentItem = this.#itemsInfo.get(itemId).parentItem;\r\n    const result = removeItem(itemId, this.#itemsInfo);\r\n\r\n    if (result.success) {\r\n      const fixedSizesSumDecrement = result.fixedSizesSumDecrement;\r\n\r\n      // The fixesSizesSum of the parent must be updated\r\n      if (fixedSizesSumDecrement !== NO_FIXED_SIZES_TO_UPDATE) {\r\n        if (parentItem === ROOT_VIEW) {\r\n          this.#fixedSizesSumRoot -= fixedSizesSumDecrement;\r\n        } else {\r\n          (this.#itemsInfo.get(parentItem.id) as GroupExtended).fixedSizesSum -=\r\n            fixedSizesSumDecrement;\r\n        }\r\n      }\r\n\r\n      // Queue re-renders\r\n      forceUpdate(this);\r\n    }\r\n\r\n    return result;\r\n  }\r\n\r\n  #handleBarDrag = (event: MouseEvent) => {\r\n    event.preventDefault();\r\n    this.#newMousePosition = getMousePosition(\r\n      event,\r\n      this.#mouseDownInfo.direction\r\n    );\r\n\r\n    this.#mouseDownInfo.mouseEvent = event;\r\n\r\n    this.#dragRAF.perform(this.#handleBarDragRAF);\r\n  };\r\n\r\n  #handleBarDragRAF = (incrementInPx?: number) => {\r\n    updateComponentsAndDragBar(\r\n      this.#mouseDownInfo,\r\n      this.#itemsInfo,\r\n      incrementInPx ?? this.#newMousePosition - this.#lastMousePosition, // Increment in px\r\n      GRID_TEMPLATE_DIRECTION_CUSTOM_VAR\r\n    );\r\n\r\n    // Sync new position with last\r\n    this.#lastMousePosition = this.#newMousePosition;\r\n  };\r\n\r\n  // Handler to remove mouse down\r\n  #removeMouseMoveHandler = () => {\r\n    document.removeEventListener(\"mousemove\", this.#handleBarDrag, {\r\n      capture: true\r\n    });\r\n  };\r\n\r\n  // Remove mousemove and mouseup handlers when mouseup\r\n  #mouseUpHandler = () => {\r\n    // Cancel RAF to prevent access to undefined references\r\n    if (this.#dragRAF) {\r\n      this.#dragRAF.cancel();\r\n    }\r\n\r\n    // Remove handlers and state after finishing the resize\r\n    this.#removeMouseMoveHandler();\r\n    resetCursorInDocument();\r\n\r\n    // Add again pointer-events\r\n    resetPointerEventsInDocumentBody();\r\n\r\n    document.removeEventListener(\"mouseup\", this.#mouseUpHandler, {\r\n      capture: true\r\n    });\r\n  };\r\n\r\n  #initializeDragBarValuesForResizeProcessing = (\r\n    direction: LayoutSplitterDirection,\r\n    index: number,\r\n    layoutItems: Item[],\r\n    event: Event\r\n  ) => {\r\n    // Initialize the values needed for drag processing\r\n    const dragBar = event.target as HTMLElement;\r\n    const dragBarContainer = dragBar.parentElement;\r\n\r\n    this.#mouseDownInfo = {\r\n      container: dragBarContainer,\r\n      containerSize:\r\n        direction === \"columns\"\r\n          ? dragBarContainer.clientWidth\r\n          : dragBarContainer.clientHeight,\r\n      direction: direction,\r\n      dragBar: dragBar,\r\n      fixedSizesSumRoot: this.#fixedSizesSumRoot,\r\n      itemStartId: layoutItems[index].id,\r\n      itemEndId: layoutItems[index + 1].id,\r\n      layoutItems: layoutItems,\r\n      mouseEvent: undefined, // MouseEvent is initialized as undefined, since this object is used for the keyboard event\r\n      RTL: isRTL()\r\n    };\r\n  };\r\n\r\n  #mouseDownHandler =\r\n    (direction: LayoutSplitterDirection, index: number, layoutItems: Item[]) =>\r\n    (event: MouseEvent) => {\r\n      // Necessary to prevent selecting the inner image (or other elements) of\r\n      // the bar item when the mouse is down\r\n      event.preventDefault();\r\n\r\n      this.#dragRAF ??= new SyncWithRAF();\r\n\r\n      this.#initializeDragBarValuesForResizeProcessing(\r\n        direction,\r\n        index,\r\n        layoutItems,\r\n        event\r\n      );\r\n\r\n      // Set mouse cursor in the document\r\n      addCursorInDocument(direction === \"columns\" ? \"ew-resize\" : \"ns-resize\");\r\n\r\n      // Remove pointer-events during drag\r\n      removePointerEventsInDocumentBody();\r\n\r\n      // Mouse position\r\n      const currentMousePosition = getMousePosition(event, direction);\r\n      this.#lastMousePosition = currentMousePosition;\r\n      this.#newMousePosition = currentMousePosition; // Also updated in mouse move\r\n\r\n      // Add listeners\r\n      document.addEventListener(\"mousemove\", this.#handleBarDrag, {\r\n        capture: true\r\n      });\r\n      document.addEventListener(\"mouseup\", this.#mouseUpHandler, {\r\n        capture: true,\r\n        passive: true\r\n      });\r\n    };\r\n\r\n  #handleResize =\r\n    (direction: LayoutSplitterDirection, index: number, layoutItems: Item[]) =>\r\n    (event: KeyboardEvent) => {\r\n      if (\r\n        (direction === \"rows\" &&\r\n          event.code !== ARROW_UP &&\r\n          event.code !== ARROW_DOWN) ||\r\n        (direction === \"columns\" &&\r\n          event.code !== ARROW_LEFT &&\r\n          event.code !== ARROW_RIGHT)\r\n      ) {\r\n        return;\r\n      }\r\n\r\n      // Prevent scroll\r\n      event.preventDefault();\r\n\r\n      this.#initializeDragBarValuesForResizeProcessing(\r\n        direction,\r\n        index,\r\n        layoutItems,\r\n        event\r\n      );\r\n\r\n      const positiveIncrement =\r\n        event.code === ARROW_RIGHT || event.code === ARROW_DOWN;\r\n\r\n      this.#handleBarDragRAF(\r\n        positiveIncrement\r\n          ? this.incrementWithKeyboard\r\n          : -this.incrementWithKeyboard\r\n      );\r\n    };\r\n\r\n  #renderItem = (\r\n    direction: LayoutSplitterDirection,\r\n    lastComponentIndex: number,\r\n    layoutItems: Item[],\r\n    item: Item,\r\n    index: number\r\n  ) => {\r\n    const itemUIModel = this.#itemsInfo.get(item.id);\r\n\r\n    return [\r\n      (item as Group).items ? (\r\n        <div\r\n          id={item.id}\r\n          class={DIRECTION_CLASS((item as Group).direction)}\r\n          part={item.id}\r\n          style={TEMPLATE_STYLE(\r\n            (item as Group).items,\r\n            this.#itemsInfo,\r\n            (itemUIModel as GroupExtended).fixedSizesSum\r\n          )}\r\n        >\r\n          {this.#renderItems(\r\n            (item as Group).direction,\r\n            (item as Group).items,\r\n            (item as Group).items.length - 1\r\n          )}\r\n        </div>\r\n      ) : (\r\n        <div id={item.id} class=\"leaf\">\r\n          <slot key={item.id} name={item.id} />\r\n        </div>\r\n      ),\r\n\r\n      item.dragBar?.hidden !== true && index !== lastComponentIndex && (\r\n        <div\r\n          // - - - Accessibility - - -\r\n          role=\"separator\"\r\n          aria-controls={getAriaControls(layoutItems, index)}\r\n          aria-disabled={this.dragBarDisabled ? \"true\" : null}\r\n          aria-label={this.barAccessibleName}\r\n          aria-orientation={direction === \"columns\" ? \"vertical\" : \"horizontal\"}\r\n          aria-valuetext={itemUIModel.actualSize}\r\n          title={this.barAccessibleName}\r\n          tabindex=\"0\"\r\n          // - - - - - - - - - - - - -\r\n          class=\"bar\"\r\n          part={item.dragBar?.part ? `bar ${item.dragBar.part}` : \"bar\"}\r\n          style={\r\n            item.dragBar?.size ? { \"--size\": `${item.dragBar.size}px` } : null\r\n          }\r\n          onKeyDown={\r\n            !this.dragBarDisabled\r\n              ? this.#handleResize(direction, index, layoutItems)\r\n              : null\r\n          }\r\n          onMouseDown={\r\n            !this.dragBarDisabled\r\n              ? this.#mouseDownHandler(direction, index, layoutItems)\r\n              : null\r\n          }\r\n        ></div>\r\n      )\r\n    ];\r\n  };\r\n\r\n  #renderItems = (\r\n    direction: LayoutSplitterDirection,\r\n    layoutItems: Item[],\r\n    lastComponentIndex: number\r\n  ) =>\r\n    layoutItems.map((item, index) =>\r\n      this.#renderItem(direction, lastComponentIndex, layoutItems, item, index)\r\n    );\r\n\r\n  #updateLayoutInfo = (layout: LayoutSplitterModel) => {\r\n    // Clear old information\r\n    this.#itemsInfo.clear();\r\n\r\n    if (layout?.items?.length > 0) {\r\n      this.#fixedSizesSumRoot = fixAndUpdateLayoutModel(\r\n        layout,\r\n        this.#itemsInfo\r\n      );\r\n    }\r\n  };\r\n\r\n  connectedCallback() {\r\n    this.#updateLayoutInfo(this.model);\r\n  }\r\n\r\n  disconnectedCallback() {\r\n    // Defensive programming. Make sure all event listeners are removed correctly\r\n    this.#mouseUpHandler();\r\n  }\r\n\r\n  render() {\r\n    const layoutModel = this.model;\r\n\r\n    if (layoutModel?.items == null) {\r\n      return \"\";\r\n    }\r\n\r\n    return (\r\n      <div\r\n        class={DIRECTION_CLASS(layoutModel.direction)}\r\n        style={TEMPLATE_STYLE(\r\n          layoutModel.items,\r\n          this.#itemsInfo,\r\n          this.#fixedSizesSumRoot\r\n        )}\r\n      >\r\n        {this.#renderItems(\r\n          layoutModel.direction,\r\n          layoutModel.items,\r\n          layoutModel.items.length - 1\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n"],"mappings":"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"}