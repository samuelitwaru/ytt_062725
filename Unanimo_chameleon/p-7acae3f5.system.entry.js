var __spreadArray=this&&this.__spreadArray||function(e,i,t){if(t||arguments.length===2)for(var n=0,d=i.length,s;n<d;n++){if(s||!(n in i)){if(!s)s=Array.prototype.slice.call(i,0,n);s[n]=i[n]}}return e.concat(s||Array.prototype.slice.call(i))};System.register(["./p-62fc4e49.system.js"],(function(e){"use strict";var i,t,n;return{setters:[function(e){i=e.r;t=e.c;n=e.h}],execute:function(){var d="ch-next-data-modeling-render{display:contents}";var s=d;var a=function(e,i){i.forEach((function(i){var t=i.Level;if(i.Type==="LEVEL"){e[i.DataType]=t.map((function(e){return e.Name}));a(e,t)}}))};var l=function(e){if(!e){return{}}var i={};e.Entities.forEach((function(e){var t=e.Level;i[e.Name]=t.map((function(e){return e.Name}));if(t){a(i,t)}}));return i};var o=e("ch_next_data_modeling_render",function(){function e(e){var n=this;this.entities=[];this.editedControl=null;this.entityWasAdded="none";this.addField=function(e){return function(i){n.addEntityItem(e,i.detail);n.updateReferences(i,true)}};this.deleteField=function(e,i){return function(t){e.remove(i+1);n.updateReferences(t)}};this.editField=function(e){return function(i){e.Name=i.detail.name;e.Type=i.detail.type;e.DataType="";n.updateReferences(i,true)}};this.addEntity=function(e){return function(i){n.entityWasAdded="adding";var t={Name:i.detail.name,Level:n.createGxCollectionCallback()};e.push(t);n.addEntityItem(t.Level,i.detail.level[0]);n.updateReferences(i,true)}};this.editEntity=function(e){return function(i){e.Name=i.detail.name;n.updateReferences(i,true)}};i(this,e);this.fieldAdded=t(this,"fieldAdded",7);this.fieldRemoved=t(this,"fieldRemoved",7);this.addingModeCommonClass=undefined;this.captions={ATT:"Attribute",ENTITY:"Entity",LEVEL:"Collection",adding:"Adding...",addNewEntity:"Add new entity",addNewField:"Add new field",cancel:"Cancel",collection:"Collection",confirm:"Confirm",delete:"Delete",deleteMode:"Confirm delete?",deleting:"Deleting...",edit:"Edit",editing:"Saving...",newEntity:"New Entity",newField:"New Field"};this.commonClass=undefined;this.createGxCollectionCallback=undefined;this.cssClass=undefined;this.dataModel=undefined;this.dataModelToEdit=undefined;this.disabled=false;this.entityAddingModeClass=undefined;this.entityClass=undefined;this.errorTexts={Empty:"Field is empty.",AlreadyDefined1:"Field ",AlreadyDefinedEntity1:"Entity ",AlreadyDefined2:" already exists."};this.fieldAddingModeClass=undefined;this.fieldClass=undefined;this.fieldContainerClass=undefined;this.fieldCommonClass=undefined;this.hideLoading=null;this.maxAtts=3;this.readonly=false;this.subFieldClass=undefined;this.subFieldAddingModeClass=undefined;this.subFieldContainerClass=undefined}e.prototype.handleDataModelChange=function(e){this.entityNameToATTs=l(e);this.entities=Object.keys(this.entityNameToATTs)};e.prototype.handleHideLoadingChange=function(){this.editedControl.hideWaitingMode();if(this.entityWasAdded==="adding"){this.entityWasAdded="finished";this.processEntityAdding()}};e.prototype.addEntityItem=function(e,i){var t={Name:i.name,Type:i.type,DataType:""};e.push(t)};e.prototype.updateReferences=function(e,i){if(i===void 0){i=false}e.stopPropagation();this.editedControl=e.target;if(i){this.fieldAdded.emit()}else{this.fieldRemoved.emit()}this.processEntityAdding()};e.prototype.processEntityAdding=function(){if(!this.editedControl||this.entityWasAdded==="none"){return}var e=this.editedControl.classList;var i=this.editedControl.firstElementChild.classList;var t=this.editedControl.firstElementChild.firstElementChild.classList;if(this.entityWasAdded==="adding"){e.remove(this.addingModeCommonClass,this.entityAddingModeClass);e.add(this.entityClass,this.commonClass);i.add(this.fieldContainerClass);t.remove.apply(t,__spreadArray([this.addingModeCommonClass],this.fieldAddingModeClass.split(" "),false));t.add(this.fieldClass,this.fieldCommonClass,this.commonClass);return}if(this.entityWasAdded==="finished"){e.remove(this.entityClass);e.add(this.addingModeCommonClass,this.entityAddingModeClass);i.remove(this.fieldContainerClass);t.remove(this.fieldClass);t.add.apply(t,__spreadArray([this.addingModeCommonClass],this.fieldAddingModeClass.split(" "),false));this.entityWasAdded="none"}};e.prototype.componentWillLoad=function(){this.handleDataModelChange(this.dataModel)};e.prototype.render=function(){var e=this;var i,t;return n("ch-next-data-modeling",{key:"b45fe5053bce54f377ae65571513c00a28839b9a",class:this.cssClass},this.dataModel!=null&&this.dataModel.Entities!=null&&this.dataModel.Entities.map((function(i,t){var d,s,a;return n("ch-next-data-modeling-item",{key:i.Name,captions:e.captions,class:e.entityClass+" "+e.commonClass,disabled:e.disabled,errorTexts:e.errorTexts,fieldNames:e.entities,name:i.Name,level:0,readonly:e.readonly,onDeleteField:!e.readonly?e.deleteField((d=e.dataModelToEdit)===null||d===void 0?void 0:d.Entities,t):null,onEditField:!e.readonly?e.editEntity((s=e.dataModelToEdit)===null||s===void 0?void 0:s.Entities[t]):null},n("ch-next-data-modeling",{class:e.fieldContainerClass},i.Level.map((function(d,s){var a,l,o;return n("ch-next-data-modeling-item",{key:d.Name,captions:e.captions,class:e.fieldClass+" "+e.fieldCommonClass+" "+e.commonClass,dataType:d.DataType,disabled:e.disabled,entityNameToATTs:e.entityNameToATTs,errorTexts:e.errorTexts,fieldNames:e.entityNameToATTs[i.Name],maxAtts:e.maxAtts,name:d.Name,readonly:e.readonly,type:d.Type,onDeleteField:!e.readonly?e.deleteField((a=e.dataModelToEdit)===null||a===void 0?void 0:a.Entities[t].Level,s):null,onEditField:!e.readonly?e.editField((l=e.dataModelToEdit)===null||l===void 0?void 0:l.Entities[t].Level[s]):null},d.Level!=null&&d.Level.length>0&&n("ch-next-data-modeling",{class:e.subFieldContainerClass},d.Level.map((function(i,a){var l,o;return n("ch-next-data-modeling-item",{key:i.Name,captions:e.captions,class:e.subFieldClass+" "+e.fieldCommonClass+" "+e.commonClass,dataType:i.DataType,disabled:e.disabled,entityNameToATTs:e.entityNameToATTs,errorTexts:e.errorTexts,fieldNames:e.entityNameToATTs[d.DataType],level:2,maxAtts:e.maxAtts,name:i.Name,readonly:e.readonly,type:i.Type,onDeleteField:!e.readonly?e.deleteField((l=e.dataModelToEdit)===null||l===void 0?void 0:l.Entities[t].Level[s].Level,a):null,onEditField:!e.readonly?e.editField((o=e.dataModelToEdit)===null||o===void 0?void 0:o.Entities[t].Level[s].Level[a]):null})})),!e.readonly&&n("ch-next-data-modeling-item",{key:"-1",captions:e.captions,class:e.subFieldAddingModeClass+" "+e.fieldCommonClass+" "+e.addingModeCommonClass+" "+e.commonClass,disabled:e.disabled,errorTexts:e.errorTexts,fieldNames:e.entityNameToATTs[d.DataType],level:2,mode:"add",type:"ATT",onNewField:e.addField((o=e.dataModelToEdit)===null||o===void 0?void 0:o.Entities[t].Level[s].Level)})))})),!e.readonly&&n("ch-next-data-modeling-item",{key:"-1",captions:e.captions,class:e.fieldAddingModeClass+" "+e.fieldCommonClass+" "+e.addingModeCommonClass+" "+e.commonClass,disabled:e.disabled,errorTexts:e.errorTexts,fieldNames:e.entityNameToATTs[i.Name],mode:"add",type:"ATT",onNewField:e.addField((a=e.dataModelToEdit)===null||a===void 0?void 0:a.Entities[t].Level)})))})),((i=this.dataModel)===null||i===void 0?void 0:i.Entities)&&!this.readonly&&n("ch-next-data-modeling-item",{key:"-1",captions:this.captions,class:this.entityAddingModeClass+" "+this.addingModeCommonClass+" "+this.commonClass,disabled:this.disabled,errorTexts:this.errorTexts,fieldNames:this.entities,level:0,mode:"add",onNewEntity:this.addEntity((t=this.dataModelToEdit)===null||t===void 0?void 0:t.Entities)},n("ch-next-data-modeling",{key:"8284d11c91f6c700a1a374b9edf8e5d50919eb54"},n("ch-next-data-modeling-item",{key:"86ebb645c9b8d8185127bd6d5cd896a2d02d5944",actionsVisible:false,captions:this.captions,class:this.fieldAddingModeClass+" "+this.fieldCommonClass+" "+this.addingModeCommonClass+" "+this.commonClass,disabled:this.disabled,errorTexts:this.errorTexts,mode:"add",showNewFieldBtn:false,type:"ATT"}))))};Object.defineProperty(e,"watchers",{get:function(){return{dataModel:["handleDataModelChange"],hideLoading:["handleHideLoadingChange"]}},enumerable:false,configurable:true});return e}());o.style=s}}}));
//# sourceMappingURL=p-7acae3f5.system.entry.js.map