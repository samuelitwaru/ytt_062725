import{r as e,c as t,g as i,a as s,w as n,h as r,H as a,f as o}from"./p-7af91c05.js";import{f as h,m as c}from"./p-b3df8b9e.js";import{T as l,d,e as f,f as u}from"./p-d031f0c4.js";import{s as p,b as m,u as g,g as b,t as v,i as w}from"./p-0978aac4.js";import{r as x,i as k}from"./p-23a9d308.js";import{f as y}from"./p-d161cf55.js";import{s as C,r as I,a as _}from"./p-95a1ae9b.js";const z=(e,t,i,s)=>{const n=e.clientY-t.getBoundingClientRect().top;const r=t.clientHeight;const a=n<=s;const o=n>r-s;if(a||o){const e=a?n-s:n-(r-s);t.scrollTop+=e/i}};const D=":host{display:contents}:host(.rtl-direction)>.drag-info{--rtl-offset:-100%}.drag-info{--rtl-offset:16px;position:fixed;left:0;top:0;-webkit-transform:translate(calc(var(--ch-tree-view-dragging-item-x) + var(--rtl-offset)), calc(var(--ch-tree-view-dragging-item-y) + 8px));transform:translate(calc(var(--ch-tree-view-dragging-item-x) + var(--rtl-offset)), calc(var(--ch-tree-view-dragging-item-y) + 8px));pointer-events:none;z-index:1;-webkit-animation:fade-in 10ms;animation:fade-in 10ms}.waiting-drop-processing{cursor:wait}.waiting-drop-processing ::slotted(*){pointer-events:none}@-webkit-keyframes fade-in{0%,100%{opacity:0}}@keyframes fade-in{0%,100%{opacity:0}}";const S=D;const T="ch-tree-view-item";const $="ch-tree-view-drop";const E="ch-tree-view";const L="checking";const O="invalid";const M="temporal-invalid";const A="valid";const R=e=>`${T}[id="${e}"]`;const F="text/plain";const V="ArrowDown";const P="ArrowUp";const Z="F2";const N=e=>e.tagName.toLowerCase()===$;const j=e=>e.tagName.toLowerCase()===T;const H=e=>e===T||e===$;const q=()=>h().find(j);const B=e=>e&&!e.editing;const Y=(e,t,i)=>`"newContainerId":"${e}","metadata":"${JSON.stringify(t)}","dropType":"${i}"`;const K="--ch-tree-view-dragging-item-x";const J="--ch-tree-view-dragging-item-y";let W=0;const U=class{constructor(i){e(this,i);this.droppableZoneEnter=t(this,"droppableZoneEnter",7);this.expandedItemChange=t(this,"expandedItemChange",7);this.itemContextmenu=t(this,"itemContextmenu",7);this.itemsDropped=t(this,"itemsDropped",7);this.selectedItemsChange=t(this,"selectedItemsChange",7);this.draggingInTheDocument=false;this.draggingInTree=false;this.rtlDirection=false;this.multiSelection=false;this.openSubTreeCountdown=750;this.selectedItemsCallback=undefined;this.scrollToEdgeOnDrag=true;this.waitDropProcessing=false}#e={[V]:e=>{const t=q();if(!B(t)){return}e.preventDefault();t.focusNextItem(c(e))},[P]:e=>{const t=q();if(!B(t)){return}e.preventDefault();t.focusPreviousItem(c(e))},[Z]:e=>{const t=q();if(!t||!t.editable){return}e.preventDefault();t.editing=true}};#t=false;#i=true;#s;#n;#r=new Map;#a;#o;#h;#c;#l;#d;#f=[];#u=[];get el(){return i(this)}droppableZoneEnter;expandedItemChange;itemContextmenu;itemsDropped;selectedItemsChange;onContextMenu(e){const t=e.target.closest(T);if(!t){return}e.preventDefault();this.itemContextmenu.emit({id:t.id,itemRef:t,metadata:t.metadata,contextmenuEvent:e})}onKeyDown(e){const t=this.#e[e.key];if(t){t(e)}}onDragStart(e){this.#r.clear();const t=e.dataTransfer.getData(F);if(t===""){return}try{const e=JSON.parse(t);this.#o=e;this.draggingInTheDocument=true;this.#a=(new Date).getTime()}catch{}}onDragEnd(){this.draggingInTheDocument=false}onDragEnter(e){this.#p(null,true);e.stopPropagation();const t=e.target;const i=t.tagName.toLowerCase();if(!H(i)){return}const s=i===T;const n=this.#m(t,s);const r=n.treeItem;const a=n.dropType;this.#l=t;if(s){this.#g(r)}if(this.#b(e,r,a)===A){t.dragState="enter"}}onDragLeave(e){const t=e.target;if(!H(t.tagName.toLowerCase())){return}t.dragState="none";if(j(t)){this.#p(t)}}#m=(e,t)=>{if(t){return{treeItem:e,dropType:"above"}}const i=e.type;return{treeItem:i==="before"?e.nextElementSibling:e.previousElementSibling,dropType:e.type}};#p=(e,t=false)=>{if(this.#l===e||t){clearTimeout(this.#n);this.#l=null}};onDrop(e){e.stopPropagation();this.#p(null,true);const t=e.target;const i=t.tagName.toLowerCase();if(!H(i)){return}t.dragState="none";const s=i===T;const n=this.#m(t,s);const r=n.treeItem;const a=n.dropType;if(this.#b(e,r,a)!==A){return}const o=JSON.parse(e.dataTransfer.getData(F));this.itemsDropped.emit({newContainer:{id:r.id,metadata:r.metadata},draggingSelectedItems:this.#t,draggedItems:o,dropInTheSameTree:this.draggingInTree,dropType:a})}onItemDragStart(e){e.stopPropagation();document.addEventListener("dragover",this.#v,{capture:true});this.#c=e.target;const t=this.#w(e.detail);if(!t){e.detail.dragEvent.dataTransfer.effectAllowed="none";return}this.draggingInTree=true;if(this.scrollToEdgeOnDrag){this.#x()}}onItemDragEnd(){this.draggingInTree=false;document.removeEventListener("dragover",this.#v,{capture:true});this.#k()}onSelectedItemChange(e){e.stopPropagation();const t=e.detail;const i=this.selectedItemsCallback();if(!t.ctrlKeyPressed||!this.multiSelection){i.clear()}if(t.selected){i.set(t.id,t)}else{i.delete(t.id)}this.selectedItemsChange.emit(i)}async scrollIntoVisible(e){s((()=>{const t=this.el.querySelector(R(e));if(!t){return}n((()=>{t.scrollIntoView()}))}))}async updateValidDropZone(e,t,i,s,n){if(!this.draggingInTheDocument||e<=this.#a){return}const r=Y(t,i,s);this.#r.set(r,n?A:O);if(!n||!this.#l){return}const a=N(this.#l)?this.#l.treeItemId:this.#l.id;const o=a===t;if(o){this.#l.dragState="enter"}}#y=e=>this.el.querySelector(R(e));#b=(e,t,i)=>{const s=Y(t.id,this.#o,i);let n=this.#r.get(s);if(n===M&&!t.lazyLoad&&!t.downloading){n=null}if(n!=null){return n}if(e.dataTransfer.effectAllowed==="none"||i==="above"&&t.dropDisabled||this.draggingInTree&&(this.#f.includes(t.id)||this.#u.includes(t.id))){this.#r.set(s,O);return O}if(i==="above"&&(t.lazyLoad||t.downloading)){this.#r.set(s,M);return M}this.#r.set(s,L);this.droppableZoneEnter.emit({newContainer:{id:t.id,metadata:t.metadata},draggedItems:this.#o,dropType:i});return L};#g=e=>{if(e.leaf||e.expanded){return}this.#n=setTimeout((()=>{e.expanded=true;this.expandedItemChange.emit({id:e.id,expanded:true})}),this.openSubTreeCountdown)};#v=e=>{const t=e.target.closest(E)!==null;if(t){e.stopImmediatePropagation()}e.preventDefault();this.#s=e;this.#C(e);if(!this.#i){return}this.#i=false;requestAnimationFrame((()=>{this.#i=true;this.el.style.setProperty(K,`${this.#s.clientX}px`);this.el.style.setProperty(J,`${this.#s.clientY}px`)}))};#C=e=>{if(!e.composedPath().includes(this.el)){return}const t=e.composedPath().find((e=>{if(!e.tagName){return false}return H(e.tagName.toLowerCase())&&e.closest(E)===this.el}));const i=t.tagName.toLowerCase()===T;const s=this.#m(t,i);const n=s.treeItem;const r=s.dropType;const a=this.#b(e,n,r);if(a===O||a===M){e.dataTransfer.dropEffect="none"}};#k=()=>{this.#f=[];this.#u=[]};#w=e=>{const t=e.elem;const i=this.selectedItemsCallback();const s=i.has(t.id);this.#t=s;let n=[];let r;if(s){const e=[...i.keys()];const s=[...i.values()];const a=e.length;r=s.every((e=>!this.#y(e.id).dragDisabled));this.#f=e;n=s.map((e=>({id:e.id,metadata:e.metadata})));this.#d=a===1?t.caption:a.toString()}else{r=!t.dragDisabled;n=[{id:t.id,metadata:t.metadata}];this.#f=[t.id];this.#d=t.caption}this.#I(s);const a=JSON.stringify(n);e.dragEvent.dataTransfer.setData(F,a);return r};#x=()=>{if(!this.draggingInTree||!this.#s){return}requestAnimationFrame((()=>{z(this.#s,this.el,10,30);requestAnimationFrame(this.#x)}))};#I=e=>{if(!e){const e=this.#c.parentElement;if(e.tagName.toLowerCase()===T){this.#u.push(e.id)}return}const t=this.selectedItemsCallback();t.forEach((e=>{const t=e.parentId;if(t!==""){this.#u.push(t)}}))};connectedCallback(){this.#h=`ch-tree-view-id-${W++}`;p(this.#h,(e=>{this.rtlDirection=e}));this.rtlDirection=m()}disconnectedCallback(){g(this.#h);this.#k();this.onItemDragEnd()}render(){return r(a,{key:"416dbbe3324ed6263c496c189b089b772e096168",class:{"dragging-item":this.draggingInTheDocument,"not-dragging-item":!this.draggingInTheDocument,"dragging-selected-items":this.draggingInTree&&this.#t,"rtl-direction":this.rtlDirection,"waiting-drop-processing":this.waitDropProcessing},exportparts:l.DRAG_PREVIEW},r("slot",{key:"604d73b77ba50a3af6a5dcb5eee4b48bbc7a8bfa"}),this.draggingInTree&&r("span",{key:"c5cc7239a7e00dcde178858ba4728ac78040de36","aria-hidden":"true",class:"drag-info",part:l.DRAG_PREVIEW},this.#d))}};U.style=S;const G=0;const Q=e=>e?d.EVEN_LEVEL:d.ODD_LEVEL;const X=e=>e?d.EXPANDED:d.COLLAPSED;const ee=(e,t,i,s)=>{let n=false;let r=false;let a=false;e.forEach((e=>{const o=t.get(e);if(o){const h=o.item;const c=o.parentItem.items;if(h.leaf!==true&&h.items?.length>0){const e=h.items.map((e=>e.id));ee(e,t,i,s)}n||=t.delete(e);r||=i.delete(e);a||=s.delete(e);x(c,c.findIndex((t=>t.id===e)))}}));return{atLeastOneElement:n,atLeastOneCheckbox:r,atLeastOneSelected:a}};const te=e=>new Promise((t=>t(e)));const ie=(e,t)=>{const i=t.get(e);if(!i){return te(false)}let s=i.parentItem;while(s&&s.id!=null){s.expanded=true;const e=t.get(s.id);s=e.parentItem}return te(true)};const se=async(e,t,i,s,n)=>{const r=new Set(t).size!==t.length;if(r){return false}const a=t.length-1;let h=a;let c=i.get(t[h]);while(c===undefined&&h>0){h--;c=i.get(t[h])}if(!c){return false}const l=h;while(h>=0){if(i.get(t[h])===undefined){return false}h--}if(i.get(t[0]).parentItem!==s){return false}const d=l!==a;const f=d&&!n;if(f){return false}let u=i.get(t[l]).parentItem;while(u!==s){u.expanded=true;u=i.get(u.id).parentItem}o(e);let p=l;while(p<a){const s=t[p];const r=i.get(s);if(!r){return false}const a=r.item;if(a.leaf===true){return false}a.downloading=true;a.expanded=true;a.lazy=false;o(e);const h=await n(s);await e.loadLazyContent(s,h);p++}return true};const ne=':host{--ch-tree-view-drop--size:8px;display:grid;position:relative;-webkit-transform:translateY(calc(var(--ch-tree-view-drop--size) * -0.5));transform:translateY(calc(var(--ch-tree-view-drop--size) * -0.5))}:host::before{content:"";display:-ms-flexbox;display:flex;position:absolute;inset-inline:0;block-size:var(--ch-tree-view-drop--size)}:host::after{display:-ms-flexbox;display:flex;position:absolute;-ms-flex-item-align:center;align-self:center;inset-block-start:calc(var(--ch-tree-view-drop--size) * 0.25);inset-inline:0;block-size:calc(var(--ch-tree-view-drop--size) * 0.5);background-color:currentColor;opacity:0}:host(.ch-tree-view-drop--drag-enter)::after{content:"";opacity:1}';const re=ne;const ae="ch-tree-view-drop";const oe=class{constructor(t){e(this,t);this.dragState="none";this.level=G;this.treeItemId=undefined;this.type="before"}render(){const e=this.level!==G;const t=Q(this.level%2===0);return r(a,{key:"9f42f64f654ea2e51790a1b53f7c60f373a29255",class:{["gx-"+t]:e,[ae+"--drag-enter"]:this.dragState==="enter"},style:{"--level":`${this.level}`}})}};oe.style=re;const he='*,::after,::before{-webkit-box-sizing:border-box;box-sizing:border-box}:where(button){all:unset;display:-ms-flexbox;display:flex;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-ms-touch-action:manipulation;touch-action:manipulation;-webkit-user-drag:element}:host{display:grid;grid-template-rows:-webkit-min-content;grid-template-rows:min-content}.header{display:-ms-flexbox;display:flex;gap:var(--ch-tree-view-item-gap);-ms-flex-align:center;align-items:center}.header--disabled{pointer-events:none}.line{--inset-inline-start:calc(var(--ch-tree-tab-size) * (var(--level) - 1) - var(--parent-offset, 0px) + var(--ch-tree-view-item-custom-padding-inline-start) + var(--ch-tree-view-item__expandable-button-size) * 0.5 + var(--ch-tree-view-item__line--inset-inline-start));position:absolute;inset-inline-start:var(--inset-inline-start);inline-size:calc(var(--ch-tree-view-item-indentation) - var(--inset-inline-start) - var(--ch-tree-view-item__line--inset-inline-end));block-size:1px;border:0 dashed color-mix(in srgb, currentColor 65%, transparent);border-block-end-width:1px;pointer-events:none;content-visibility:hidden;z-index:1}.last-all-line{inset-block-start:0;height:calc(100% - var(--ch-tree-view-item-distance-to-checkbox));border-inline-start-width:1px;border-end-start-radius:2px}.last-line{inset-block-start:0;height:100%;border-inline-start-width:1px;border-style:solid;-webkit-border-after:unset;border-block-end:unset}.expandable-button,.expandable-button-decorative::before{display:grid;place-items:center;inline-size:var(--ch-tree-view-item__expandable-button-size);block-size:var(--ch-tree-view-item__expandable-button-size);z-index:1;cursor:pointer}.expandable-button-decorative::before{content:"";background-color:currentColor;-webkit-mask:url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" fill="none"><path d="M16.5 5L8.7 12.7L1 5" stroke="%23000" stroke-width="1.2" stroke-linecap="round"/></svg>\') 50% 50%/calc(100% - 4px) calc(100% - 4px) no-repeat;cursor:unset}.expandable-button-decorative--collapsed::before{-webkit-transform:rotate(-90deg);transform:rotate(-90deg)}.expandable-button::before{content:"";inline-size:calc(100% - 4px);block-size:calc(100% - 4px);background-color:currentColor;-webkit-mask-size:calc(var(--ch-tree-view-item__expandable-button-size) - 4px)}.expandable-button--collapsed::before{-webkit-mask-image:url(\'data:image/svg+xml,<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M14.15,8.5H8.54v5.61h-1V8.5H1.93v-1H7.54V1.89h1V7.5h5.61Z"/></svg>\')}.expandable-button--expanded::before{-webkit-mask-image:url(\'data:image/svg+xml,<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M14.15,8.5H1.93v-1H14.15Z"/></svg>\')}.expandable-button:focus-visible{outline:1px solid currentColor}.checkbox{inline-size:var(--ch-tree-view-item__checkbox-size);--ch-checkbox__container-size:var(--ch-tree-view-item__checkbox-size)}.action{display:grid;grid-template:"start-img text"/max-content 1fr;gap:var(--ch-tree-view-item-gap);-ms-flex-align:center;align-items:center;block-size:100%;-ms-flex:1;flex:1;cursor:pointer}.action--end-img{grid-template:"start-img text end-img"/max-content 1fr -webkit-max-content;grid-template:"start-img text end-img"/max-content 1fr max-content}.edit-caption{grid-area:text;inline-size:100%;block-size:100%;padding:0;margin:0;background-color:unset;border:unset;color:unset;font:unset;outline:unset}.pseudo-img--start::before,.pseudo-img--end::after,.img{display:block;inline-size:var(--ch-tree-view-item__image-size);block-size:var(--ch-tree-view-item__image-size);content-visibility:auto;contain-intrinsic-size:auto var(--ch-tree-view-item__image-size)}.pseudo-img--start::before,.start-img{content:"";grid-area:start-img}.pseudo-img--end::after,.end-img{content:"";grid-area:end-img}.start-img-type--background::before{background:no-repeat center/100% var(--ch-start-img)}.end-img-type--background::after{background:no-repeat center/100% var(--ch-end-img)}.start-img-type--mask::before{-webkit-mask:var(--ch-start-img) 50% 50%/100% 100% no-repeat;background-color:currentColor}.end-img-type--mask::after{-webkit-mask:var(--ch-end-img) 50% 50%/100% 100% no-repeat;background-color:currentColor}.downloading{inline-size:0.75em;block-size:0.75em;margin-inline:8px 2px;border:2px solid currentColor;border-inline-start-color:transparent;border-radius:50%;opacity:0.75;-webkit-animation:spin 1s linear infinite, avoid-flickering 75ms;animation:spin 1s linear infinite, avoid-flickering 75ms}@-webkit-keyframes avoid-flickering{0%,100%{display:none}}@keyframes avoid-flickering{0%,100%{display:none}}@-webkit-keyframes spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}.expandable{display:grid;grid-auto-rows:-webkit-min-content;grid-auto-rows:min-content;position:relative}.expandable--lazy-loaded{content-visibility:auto;contain-intrinsic-size:auto 100px}.expandable--collapsed{display:none;overflow:hidden}';const ce=he;const le="--ch-tree-view-item-distance-to-checkbox";const de="ch-tree-view-item";const fe=`:scope>${de}`;const ue=`${de}:not([disabled])`;const pe=`:scope>${de}:last-child`;const me=`item-deny-drop`;const ge=`${d.IMAGE} ${d.START_IMAGE}`;const be=`${d.IMAGE} ${d.END_IMAGE}`;const ve="expandable";const we="Enter";const xe="Escape";const ke=class{constructor(i){e(this,i);this.checkboxChange=t(this,"checkboxChange",7);this.checkboxToggleChange=t(this,"checkboxToggleChange",7);this.itemDragStart=t(this,"itemDragStart",7);this.itemDragEnd=t(this,"itemDragEnd",7);this.loadLazyContent=t(this,"loadLazyContent",7);this.modifyCaption=t(this,"modifyCaption",7);this.openReference=t(this,"openReference",7);this.selectedItemChange=t(this,"selectedItemChange",7);this.caption=undefined;this.checkbox=false;this.checked=false;this.customRender=false;this.disabled=false;this.dragDisabled=false;this.dropDisabled=false;this.dragState="none";this.downloading=false;this.editable=undefined;this.editing=false;this.endImgSrc=undefined;this.endImgType="background";this.expandableButton="decorative";this.expandOnClick=true;this.expanded=false;this.lastItem=false;this.lazyLoad=false;this.leaf=false;this.level=G;this.indeterminate=false;this.metadata=undefined;this.parts=undefined;this.selected=false;this.showDownloadingSpinner=true;this.showLines="none";this.startImgSrc=undefined;this.startImgType="background";this.toggleCheckboxes=false}#_;#z=false;#D;#S;get el(){return i(this)}updateChildrenCheckedValue(e){if(!this.toggleCheckboxes||this.leaf||this.#z){this.#z=false;return}const t=this.#T();t.forEach((t=>{if(t.checked!==e||t.indeterminate!==false){t.updateChecked(e,false)}}))}editingChanged(e){if(!e){return}document.addEventListener("click",this.#$,{capture:true});n((()=>{requestAnimationFrame((()=>{if(this.#S){this.#S.focus()}}))}))}expandedChanged(e){setTimeout((()=>{this.#E(e)}))}lastItemChanged(e){if(e&&this.showLines){requestAnimationFrame((()=>{this.#L()}))}else{this.#O()}}partsChanged(e){this.#M(e)}showLinesChanged(e){if(e&&this.lastItem){this.#L()}else{this.#O()}}handleToggleCheckboxesChange(e){if(e){this.el.addEventListener("checkboxChange",this.#A)}else{this.el.removeEventListener("checkboxChange",this.#A)}}checkboxChange;checkboxToggleChange;itemDragStart;itemDragEnd;loadLazyContent;modifyCaption;openReference;selectedItemChange;async focusNextItem(e){if(!this.leaf&&this.expanded){const t=this.el.querySelector(ue);if(t){t.setFocus(e);return}}this.focusNextSibling(e)}async focusNextSibling(e){const t=this.el.nextElementSibling;if(t){if(t.disabled){t.focusNextItem(e)}else{t.setFocus(e)}return}if(this.level===G){return}const i=this.el.parentElement;i.focusNextSibling(e)}async focusPreviousItem(e){const t=this.el.previousElementSibling;if(t){t.focusLastItem(e);return}if(this.level===G){return}const i=this.el.parentElement;if(i.disabled){i.focusPreviousItem(e);return}i.setFocus(e)}async focusLastItem(e){if(!this.leaf&&this.expanded){const t=this.el.querySelector(pe);if(t){t.focusLastItem(e);return}}if(this.disabled){this.focusPreviousItem(e);return}this.setFocus(e)}async setFocus(e){this.#D.focus();if(!e){this.#R()}}async updateChecked(e,t){this.checked=e;this.indeterminate=t;this.checkboxToggleChange.emit({id:this.el.id,checked:e,indeterminate:t})}#T=()=>Array.from(this.el.querySelectorAll(fe));#L=()=>{this.#_=new ResizeObserver((()=>{const e=this.el.getBoundingClientRect().height-this.#D.getBoundingClientRect().height/2;this.el.style.setProperty(le,e+"px")}));this.#_.observe(this.el);this.#_.observe(this.#D)};#O=()=>{if(!this.#_){return}this.#_.disconnect();this.#_=null};#F=e=>{e.stopPropagation();if(e.code!==we&&e.code!==xe){return}e.preventDefault();const t=e.code===we;this.#V(true,t)()};#$=e=>{if(!e.composedPath().includes(this.#S)&&e.pointerType){this.#V(false)()}};#V=(e,t=false)=>()=>{if(!this.editing){return}this.editing=false;document.removeEventListener("click",this.#$,{capture:true});const i=this.#S.value;if(t&&i.trim()!==""){this.modifyCaption.emit({id:this.el.id,caption:i})}if(e){this.#D.focus()}};#P=e=>{e.stopPropagation();if(!this.leaf){this.expanded=!this.expanded}this.selected=true;this.selectedItemChange.emit(this.#Z(c(e),true))};#E=e=>{if(!this.lazyLoad||!e){return}this.lazyLoad=false;this.downloading=true;this.loadLazyContent.emit(this.el.id)};#N=()=>{const e=!this.selected;this.selected=e;this.selectedItemChange.emit(this.#Z(true,e))};#R=()=>{this.selected=true;this.selectedItemChange.emit(this.#Z(false,true))};#j=e=>{if(c(e)){this.#N();return}if(e.detail>=2){return}if(this.expandOnClick){this.#P(e)}else{this.#R()}};#Z=(e,t)=>({ctrlKeyPressed:e,expanded:this.expanded,id:this.el.id,metadata:this.metadata,parentId:this.el.parentElement?.id,selected:t});#H=e=>{e.stopPropagation();if(c(e)){this.#N();return}this.#q();if(!this.leaf&&!this.expandOnClick){this.#P(e)}};#B=e=>{e.stopPropagation();if(this.editing){return}e.preventDefault();if(e.pointerType){this.#j(e);return}this.#q();this.#P(e)};#Y=e=>{if(c(e)&&e.code===we){e.stopPropagation();this.#N()}};#q=()=>{this.openReference.emit({id:this.el.id,leaf:this.leaf,metadata:this.metadata})};#K=e=>{e.stopPropagation();const t=e.target;const i=t.checkedValue===t.value;this.checked=i;this.indeterminate=false;this.checkboxChange.emit({id:this.el.id,checked:this.checked,indeterminate:false})};#A=e=>{if(this.el===e.target){return}const t=e.detail.checked;const i=this.#T();const s=i.every((e=>e.checked===t));const n=this.checked!==t||this.indeterminate!==!s;this.#z=this.checked!==t;this.checked=t;this.indeterminate=!s;if(n){this.checkboxToggleChange.emit({id:this.el.id,checked:t,indeterminate:!s})}};#J=(e,t,i)=>i==="img"&&t&&r("img",{"aria-hidden":"true",class:e,part:e,alt:"",src:t,loading:"lazy"});#W=e=>{if(this.editing){e.preventDefault();e.stopPropagation();return}b(e);e.dataTransfer.effectAllowed="move";this.dragState="start";this.itemDragStart.emit({elem:this.el,dragEvent:e})};#U=()=>{this.dragState="none";this.itemDragEnd.emit()};#M=e=>{if(e){this.el.setAttribute("exportparts",`${f},${e.replace(/\s+/g,",")}`)}else{this.el.setAttribute("exportparts",f)}};connectedCallback(){if(this.toggleCheckboxes){this.el.addEventListener("checkboxChange",this.#A)}this.el.setAttribute("role","treeitem");this.el.setAttribute("aria-level",`${this.level+1}`);this.el.style.setProperty("--level",`${this.level}`);this.#M(this.parts)}componentWillLoad(){this.#E(this.expanded)}componentDidLoad(){if(this.lastItem&&this.showLines){this.#L()}}disconnectedCallback(){if(this.editing){this.#V(false)}this.#O();this.el.removeEventListener("checkboxChange",this.#A)}render(){const e=this.level%2===0;const t=!this.leaf&&!this.lazyLoad;const i=this.level!==G;const s=this.showLines==="all"&&i;const n=this.showLines==="last"&&i&&this.lastItem;const o=Q(e);const h=X(this.expanded);const c=w(this.startImgSrc,this.startImgType);const f=w(this.endImgSrc,this.endImgType);const p=!!this.parts;return r(a,{key:"ef81616736a8e530f20b1fff1f073005d7464e5a","aria-selected":this.selected?"true":null,class:this.leaf?me:null,part:v({[l.ITEM]:true,[l.DRAG_ENTER]:this.dragState==="enter",[this.parts]:p})},r("button",{key:"95072680ba1f96e1a7fb6e1017f652684f911176","aria-controls":t?ve:null,"aria-expanded":t?this.expanded.toString():null,class:{header:true,"header--selected":this.selected,"header--disabled":this.disabled,"expandable-button-decorative":!this.leaf&&this.expandableButton==="decorative","expandable-button-decorative--collapsed":!this.leaf&&this.expandableButton==="decorative"&&!this.expanded},part:v({[d.HEADER]:true,[d.DISABLED]:this.disabled,[d.DRAG_ENTER]:this.dragState==="enter",[d.SELECTED]:this.selected,[d.NOT_SELECTED]:!this.selected,[d.EXPAND_BUTTON]:i&&!this.leaf&&this.expandableButton!=="no",[this.editing?d.EDITING:d.NOT_EDITING]:true,[o]:i,[this.parts]:p}),type:"button",disabled:this.disabled,onClick:this.#B,onKeyDown:!this.editing?this.#Y:null,draggable:!this.dragDisabled,onDragStart:this.#W,onDragEnd:!this.dragDisabled&&this.dragState==="start"?this.#U:null,ref:e=>this.#D=e},!this.leaf&&this.expandableButton==="action"&&r("button",{key:"expandable-button",type:"button",class:{"expandable-button":true,"expandable-button--expanded":this.expanded,"expandable-button--collapsed":!this.expanded},part:v({[d.EXPANDABLE_BUTTON]:true,[d.DISABLED]:this.disabled,[h]:true,[this.parts]:p}),disabled:this.disabled,onClick:this.#P}),this.checkbox&&r("ch-checkbox",{key:"checkbox",accessibleName:this.caption,class:"checkbox",exportparts:u,part:p?`${d.CHECKBOX} ${this.parts}`:d.CHECKBOX,checkedValue:"true",disabled:this.disabled,indeterminate:this.indeterminate,unCheckedValue:"false",value:`${this.checked}`,onInput:this.#K}),this.customRender?r("slot",{name:"custom-content"}):[r("div",{class:{action:true,"action--end-img":!!this.endImgSrc,[`start-img-type--${this.startImgType} pseudo-img--start`]:c,[`end-img-type--${this.endImgType} pseudo-img--end`]:f},part:v({[d.ACTION]:true,[this.editing?d.EDITING:d.NOT_EDITING]:true,[h]:!this.leaf,[this.parts]:p}),style:{"--ch-start-img":c?`url("${this.startImgSrc}")`:null,"--ch-end-img":f?`url("${this.endImgSrc}")`:null},onDblClick:!this.editing?this.#H:null},this.#J(p?`${ge} ${this.parts}`:ge,this.startImgSrc,this.startImgType),this.editable&&this.editing?r("input",{key:"edit-caption",class:"edit-caption",part:p?`${d.EDIT_CAPTION} ${this.parts}`:d.EDIT_CAPTION,disabled:this.disabled,type:"text",value:this.caption,onBlur:this.#V(false),onKeyDown:this.#F,ref:e=>this.#S=e}):this.caption,this.#J(p?`${be} ${this.parts}`:be,this.endImgSrc,this.endImgType)),this.showDownloadingSpinner&&!this.leaf&&this.downloading&&r("div",{class:"downloading",part:p?`${d.DOWNLOADING} ${this.parts}`:d.DOWNLOADING})],(s||n)&&r("div",{key:"line",class:{line:true,"last-all-line":s&&this.lastItem,"last-line":n},part:v({[d.LINE]:true,[d.LAST_LINE]:this.lastItem,[this.parts]:p})})),t&&r("div",{key:"780f207e07b450d6dde0984f97d44507c369de54",role:"group","aria-busy":(!!this.downloading).toString(),"aria-live":this.downloading?"polite":null,id:ve,class:{expandable:true,"expandable--collapsed":!this.expanded,"expandable--lazy-loaded":!this.downloading,"expandable--even":i&&e,"expandable--odd":i&&!e},part:v({[d.GROUP]:true,[d.LAZY_LOADED]:!this.downloading,[h]:true,[o]:i,[this.parts]:p})},r("slot",{key:"c02a22991e900cf255ef32fb11bcc30c564aac46"})))}static get watchers(){return{checked:["updateChildrenCheckedValue"],editing:["editingChanged"],expanded:["expandedChanged"],lastItem:["lastItemChanged"],parts:["partsChanged"],showLines:["showLinesChanged"],toggleCheckboxes:["handleToggleCheckboxesChange"]}}};ke.style=ce;const ye=(e,t)=>e.checkbox??t;const Ce=(e,t,i)=>i?e.includes(t):e.toLowerCase().includes(t.toLowerCase());const Ie=(e,t,i)=>i?.regularExpression?e.match(t)!==null:Ce(e,t,i?.matchCase);const _e={caption:(e,t)=>t.filter?Ie(e.caption??"",t.filter,t.filterOptions):true,checked:(e,t)=>ye(e,t.defaultCheckbox)&&!e.indeterminate&&(e.checked??t.defaultChecked),list:(e,t)=>t.filterSet.has(e.id),metadata:(e,t)=>t.filter?Ie(e.metadata??"",t.filter,t.filterOptions):true,none:()=>true,unchecked:(e,t)=>ye(e,t.defaultCheckbox)&&!e.indeterminate&&!(e.checked??t.defaultChecked)};const ze=(e,t,i)=>i.filterOptions?.hideMatchesAndShowNonMatches===true?!_e[e](t,i):_e[e](t,i);const De=async(e,t,i,s,n,r,a,o)=>{const h=i.get(t);if(!s||!h||h.item.leaf===true){return false}const c=!a&&!o;if(c){a={downloading:true};o={downloading:false}}if(a){e.updateItemsProperties([t],a)}const l=await s(t);const d=new Set(h.item.items.map((e=>e.id)));const f=[];l.forEach((e=>{const t=i.get(e.id);if(t&&d.has(e.id)){const i=t.item;e.checked=i.checked;e.expanded=i.expanded;e.indeterminate=i.indeterminate;e.selected=i.selected;const s=e.lazy&&i.lazy===false;if(s){e.lazy=false;e.items=i.items;f.push(e.id)}d.delete(e.id)}}));if(d.size>0){r([...d.keys()])}await n(t,l);if(o){e.updateItemsProperties([t],o)}await Promise.allSettled(f.map((t=>De(e,t,i,s,n,r))));return true};const Se=(e,t,i,s,n,r)=>{const a=i.get(e);if(!a){return}const o=a.item;Object.keys(t).forEach((e=>{if(t[e]!==undefined){o[e]=t[e]}}));if(t.selected){s.add(e)}else if(t.selected===false){s.delete(e)}if(ye(o,r)){n.set(e,a)}else{n.delete(e)}};const Te=":host{--ch-tree-view-item-custom-padding-inline-start:0px;--ch-tree-view-item-gap:0px;--ch-tree-view-item__checkbox-size:0.875em;--ch-tree-view-item__expandable-button-size:0.875em;--ch-tree-view-item__image-size:0.875em;--ch-tree-view-item__line--inset-inline-start:0px;--ch-tree-view-item__line--inset-inline-end:0px;--ch-tree-tab-size:calc(\n    var(--ch-tree-view-item__image-size) +\n      var(--ch-tree-view-item__expandable-button-size) +\n      (var(--ch-tree-view-item-gap) * 2)\n  );display:grid;grid-auto-rows:-webkit-max-content;grid-auto-rows:max-content;block-size:100%;overflow:auto;contain:size}.dragging-item ch-tree-view-item{pointer-events:var(--ch-tree-view-pointer-events, all)}.dragging-item .item-deny-drop{pointer-events:none}.dragging-selected-items ch-tree-view-item[selected]{--ch-tree-view-pointer-events:none}::part(item__header),ch-tree-view-drop{--own-offset:0px;--ch-tree-view-item-indentation:calc(\n    var(--ch-tree-tab-size) * var(--level) - var(--own-offset) -\n      var(--parent-offset, 0px) +\n      var(--ch-tree-view-item-custom-padding-inline-start)\n  )}::part(item__header expand-button),ch-tree-view-drop{--own-offset:calc(\n    var(--ch-tree-view-item__expandable-button-size) +\n      var(--ch-tree-view-item-gap)\n  )}::part(item__header even-level),ch-tree-view-drop.gx-even-level{--parent-offset:var(--parent-offset-odd)}::part(item__header odd-level),ch-tree-view-drop.gx-odd-level{--parent-offset:var(--parent-offset-even)}ch-tree-view-drop{-webkit-margin-start:var(--ch-tree-view-item-indentation);margin-inline-start:var(--ch-tree-view-item-indentation)}::part(item__header){-webkit-padding-start:var(--ch-tree-view-item-indentation);padding-inline-start:var(--ch-tree-view-item-indentation)}::part(item__group even-level){--parent-offset-even:calc(\n    var(--ch-tree-view-item__expandable-button-size) +\n      var(--ch-tree-view-item-gap) + var(--parent-offset-odd, 0px)\n  )}::part(item__group odd-level){--parent-offset-odd:calc(\n    var(--ch-tree-view-item__expandable-button-size) +\n      var(--ch-tree-view-item-gap) + var(--parent-offset-even, 0px)\n  )}ch-tree-view-item>ch-tree-view-drop:first-child{-webkit-transform:translateY(0);transform:translateY(0)}ch-tree-view-item>ch-tree-view-drop:first-child::after{inset-block-start:0px}ch-tree-view-item>ch-tree-view-drop:last-child{-webkit-transform:translateY(calc(var(--ch-tree-view-drop--size) * -1));transform:translateY(calc(var(--ch-tree-view-drop--size) * -1))}ch-tree-view-item>ch-tree-view-drop:last-child::after{inset-block-start:calc(var(--ch-tree-view-drop--size) * 0.5)}";const $e=Te;let Ee=0;const Le=null;const Oe=false;const Me=false;const Ae=true;const Re=false;const Fe=false;const Ve=false;const Pe=0;const Ze=false;const Ne=(e,t)=>e!=="none"&&(e!=="caption"&&e!=="metadata"||t!=null&&t.trim()!=="");const je=(e,t,i)=>i?y(e,t.gxSettings,t.gxImageConstructor):e;const He=(e,t)=>e.dragEnabled!=null?!e.dragEnabled:t.dragDisabled;const qe=(e,t)=>e.dropEnabled!=null?!e.dropEnabled:t.dropDisabled;const Be=(e,t,i)=>i?qe(e,t):e.dropDisabled??t.dropDisabled;const Ye=e=>`ch-tree-view-drop__${e}`;const Ke=(e,t,i,s,n,a,o=false)=>(t.filterType==="none"||e.render!==false)&&[a&&r("ch-tree-view-drop",{id:Ye(e.id),level:n,treeItemId:e.id,type:"before"}),r("ch-tree-view-item",{key:e.id,id:e.id,caption:e.caption,checkbox:e.checkbox??t.checkbox,checked:e.checked??t.checked,disabled:o?e.enabled===false:e.disabled,downloading:e.downloading,dragDisabled:o?He(e,t):e.dragDisabled??t.dragDisabled,dropDisabled:Be(e,t,o),editable:e.editable??t.editableItems,endImgSrc:t.getImagePathCallback(e.endImgSrc,t,o),endImgType:e.endImgType??"background",expanded:e.expanded,expandableButton:t.expandableButton,expandOnClick:t.expandOnClick,indeterminate:e.indeterminate,lastItem:s,lazyLoad:e.lazy,leaf:e.leaf,level:n,metadata:e.metadata,parts:e.parts,selected:e.selected,showLines:t.showLines,toggleCheckboxes:e.toggleCheckboxes??t.toggleCheckboxes,startImgSrc:t.getImagePathCallback(e.startImgSrc,t,o),startImgType:e.startImgType??"background"},t.expanded&&!e.leaf&&e.items!=null&&e.items.map(((s,r)=>t.renderItem(s,t,i,t.showLines!=="none"&&(i&&e.lastItemId!==undefined?s.id===e.lastItemId:r===e.items.length-1),n+1,t.dropMode!=="above"&&Be(e,t,o)!==true,o)))),a&&s&&r("ch-tree-view-drop",{id:Ye(e.id)+"-after",level:n,treeItemId:e.id,type:"after"})];const Je=e=>{e.sort(((e,t)=>{if(e.order<t.order){return-1}if(e.order>t.order){return 0}return e.caption<=t.caption?-1:0}))};const We=class{constructor(i){e(this,i);this.checkedItemsChange=t(this,"checkedItemsChange",7);this.itemContextmenu=t(this,"itemContextmenu",7);this.itemOpenReference=t(this,"itemOpenReference",7);this.selectedItemsChange=t(this,"selectedItemsChange",7);this.expanded=true;this.waitDropProcessing=false;this.checkbox=false;this.checked=false;this.checkDroppableZoneCallback=undefined;this.dragDisabled=Oe;this.dropDisabled=Me;this.dropItemsCallback=undefined;this.dropMode="above";this.editableItems=Ae;this.expandableButton="decorative";this.expandOnClick=true;this.filter=undefined;this.filterDebounce=250;this.filterList=[];this.filterOptions={};this.filterType="none";this.gxImageConstructor=undefined;this.gxSettings=undefined;this.getImagePathCallback=je;this.lazyLoadTreeItemsCallback=undefined;this.modifyItemCaptionCallback=undefined;this.multiSelection=false;this.model=[];this.renderItem=Ke;this.showLines="none";this.sortItemsCallback=Je;this.toggleCheckboxes=false;this.useGxRender=false}#G=new Map;#Q=new Map;#X=new Set;#ee=false;#te=false;#ie;#se=false;#ne;#re;#ae;#h;#oe;get el(){return i(this)}filterChanged(){if(this.filterType==="caption"||this.filterType==="metadata"){this.#he()}}filterDebounceChanged(){if(this.filterType==="caption"||this.filterType==="metadata"){this.#he()}}filterListChanged(){this.#ae=new Set(this.filterList);if(this.filterType==="list"){this.#he()}}filterOptionsChanged(){this.#he()}filterTypeChanged(){this.#he()}multiSelectionChanged(e){if(!e){this.#ce(this.#X)}}modelChanged(){this.#le()}checkedItemsChange;itemContextmenu;itemOpenReference;selectedItemsChange;async dropItems(e,t,i){if(!e){return}const s=t.newContainer.id;const n=this.#G.get(s);const r=t.dropType;const a=r==="above"?n.item:n.parentItem;if(t.dropInTheSameTree){let e=undefined;if(r!=="above"){e={index:a.items.findIndex((e=>e.id===t.newContainer.id))};if(r==="after"){e.index++}}t.draggedItems.forEach(this.#de(a,e));if(t.draggingSelectedItems){this.#fe()}}else{if(i==null){return}a.items.push(...i);i.forEach(this.#ue(a))}this.#pe(a.items);a.expanded=true;this.#me();this.#he();o(this)}async getItemsInfo(e){return this.#ge(e)}#ge=e=>{const t=[];e.forEach((e=>{const i=this.#G.get(e);if(i){t.push(i)}}));return t};async loadLazyContent(e,t,i=false,s=false){const n=this.#G.get(e).item;n.downloading=i;n.lazy=s;if(t==null){return}n.items=t;this.#pe(n.items);this.#be(n);this.#me();this.#he();o(this)}async removeItems(e){const t=ee(e,this.#G,this.#Q,this.#X);if(!this.#ve()){if(t.atLeastOneSelected){this.#we()}if(t.atLeastOneCheckbox){this.#me()}}if(t.atLeastOneElement){o(this);this.#he("immediate")}}async reloadItems(e,t,i){const s=await De(this.el,e,this.#G,this.lazyLoadTreeItemsCallback,((e,t)=>this.loadLazyContent(e,t)),(e=>this.removeItems(e)),t,i);return s}async scrollIntoVisible(e,t){const i=typeof e==="string";const s=await(i?ie(e,this.#G):se(this.el,e,this.#G,this.#ie,this.lazyLoadTreeItemsCallback));if(!s){return false}const n=i?e:e[e.length-1];let r=this.#G.get(n).parentItem;while(r!==this.#ie){r.expanded=true;r=this.#G.get(r.id).parentItem}if(t){this.updateItemsProperties([n],t)}o(this);requestAnimationFrame((()=>{this.#oe.scrollIntoVisible(n)}));return true}async toggleItems(e,t){if(!e){return[]}const i=[];e.forEach((e=>{const s=this.#G.get(e).item;if(s){s.expanded=t??!s.expanded;i.push({id:s.id,expanded:s.expanded})}}));o(this);return i}async updateAllItemsProperties(e){[...this.#G.values()].forEach((t=>{if(e.expanded!=null){t.item.expanded=e.expanded}if(e.checked!=null){t.item.checked=e.checked;t.item.indeterminate=false}}));if(e.checked!=null){this.#he()}o(this)}async updateItemsProperties(e,t){const i=new Set(this.#X);const s=new Map(this.#Q);e.forEach((e=>{Se(e,t,this.#G,i,s,this.checkbox)}));if(!this.multiSelection){this.#ce(i)}if(this.#ve()){this.#he()}else{this.#xe(s);this.#ke(i)}o(this)}async updateValidDropZone(e,t,i,s,n){this.#oe.updateValidDropZone(e,t,i,s,n)}onCheckboxChange(e){e.stopPropagation();const t=e.detail;const i=t.id;const s=this.#Q.get(i);if(!s){return}const n=s.item;n.checked=t.checked;n.indeterminate=t.indeterminate;this.#me();if(this.filterType==="checked"||this.filterType==="unchecked"){this.#he()}o(this)}onLoadLazyContent(e){if(!this.lazyLoadTreeItemsCallback){return}e.stopPropagation();const t=e.detail;const i=this.lazyLoadTreeItemsCallback(t);e.target.downloading=true;i.then((e=>{this.loadLazyContent(t,e)}))}onModifyCaption(e){if(!this.modifyItemCaptionCallback){return}e.stopPropagation();const t=e.target;const i=e.detail.id;const s=this.#G.get(i);const n=s.item;const r=e.detail.caption;const a=n.caption;n.caption=r;t.caption=r;const h=this.modifyItemCaptionCallback(i,r);h.then((e=>{if(e.success){this.#pe(s.parentItem.items);this.#he();o(this)}else{t.caption=a;n.caption=a}}))}onOpenReference(e){e.stopPropagation();this.itemOpenReference.emit(e.detail)}#ye=e=>{if(!this.checkDroppableZoneCallback){return}e.stopPropagation();const t=(new Date).getTime();const i=e.detail;const s=this.checkDroppableZoneCallback(i);s.then((e=>{this.updateValidDropZone(t,i.newContainer.id,i.draggedItems,i.dropType,e)}))};#Ce=e=>{e.stopPropagation();const t=new Map(e.detail);const i=this.#X;i.forEach((e=>{const s=this.#G.get(e).item;const n=t.get(e);if(n){s.expanded=n.expanded;t.delete(e)}else{s.selected=false;i.delete(e)}}));t.forEach(((e,t)=>{const s=this.#G.get(t).item;s.selected=true;s.expanded=e.expanded;i.add(t)}));o(this);this.#we()};#Ie=e=>{const t=e.detail;const i=this.#G.get(t.id).item;i.expanded=t.expanded};#_e=e=>{e.stopPropagation();this.itemContextmenu.emit(e.detail)};#ze=e=>{const t=e.detail;const i=t.newContainer;const s=i.id;if(!this.#G.get(s)){return}const n=t.draggedItems;if(n.length===0||!this.dropItemsCallback){return}e.stopPropagation();const r=this.dropItemsCallback(t);this.waitDropProcessing=true;r.then((async e=>{this.dropItems(e.acceptDrop,t,e.model);this.waitDropProcessing=false}))};#ce=e=>{if(e.size>1){const t=[...e.values()];const i=e.size-1;for(let e=0;e<i;e++){const i=t[e];this.#G.get(i).item.selected=false}e.clear();e.add(t[i]);this.#fe()}};#de=(e,t)=>(i,s)=>{const n=this.#G.get(i.id);const r=n.item;const a=n.parentItem;const o=a.items.findIndex((e=>e.id===r.id));x(a.items,o);if(t!==undefined){let i=t.index+s;if(a.id===e.id&&o<i){i--;t.index--}k(e.items,r,i)}else{e.items.push(r)}n.parentItem=e};#be=e=>{const t=e.items;if(!t){if(e.leaf!==true){e.items=[]}return}this.#pe(t);t.forEach(this.#ue(e))};#ue=e=>t=>{this.#G.set(t.id,{parentItem:e,item:t});if(this.#De(t)){this.#Q.set(t.id,{parentItem:e,item:t})}t.expanded??=Re;t.indeterminate??=Fe;t.lazy??=Ve;t.order??=Pe;t.selected??=Ze;if(t.selected){this.#X.add(t.id)}this.#be(t)};#De=e=>ye(e,this.checkbox);#ve=()=>Ne(this.filterType,this.filter);#pe=e=>{if(this.dropMode==="above"&&this.sortItemsCallback){this.sortItemsCallback(e)}};#le=()=>{this.#G.clear();this.#Q.clear();this.#X.clear();this.#ie={id:Le,caption:Le,items:this.model};this.#be(this.#ie);this.#he();this.#fe();this.#me()};#Se=(e,t,i,s)=>{let n=false;if(e.leaf!==true&&e.items!=null){let r=undefined;e.items.forEach((e=>{const a=this.#Se(e,t,i,s);n||=a;if(a){r=e.id}}));e.lastItemId=r}const r=n||ze(this.filterType,e,t);e.render=r;if(r&&e.id!==Le){if(e.selected){i.add(e.id)}if(this.#De(e)){const t=this.#G.get(e.id);s.set(e.id,t)}}return r};#me=()=>{this.#te=true};#fe=()=>{this.#ee=true};#we=()=>{const e=this.#ge([...this.#X.keys()]);this.selectedItemsChange.emit(e)};#Te=()=>{const e=new Map(this.#Q);e.forEach((e=>{e.item.checked??=this.checked}));this.checkedItemsChange.emit(e)};#he=e=>{this.#se=true;if(e!==undefined){this.#ne??=e}};#xe=e=>{if(e.size!==this.#Q.size){this.#te=true}else{this.#Q.forEach(((t,i)=>{if(!e.has(i)){this.#te=true}}))}this.#Q=e};#ke=e=>{if(e.size!==this.#X.size){this.#ee=true}else{this.#X.forEach((t=>{if(!e.has(t)){this.#G.get(t).item.selected=false;this.#ee=true}}))}this.#X=e};#$e=()=>{if(this.filterType==="none"){const e=new Map;this.#G.forEach(((t,i)=>{if(this.#De(t.item)){e.set(i,t)}}));this.#xe(e);this.#Ee();return}clearTimeout(this.#re);const e=this.filterDebounce>0&&(this.filterType==="caption"||this.filterType==="metadata");const t=()=>{const e=new Set;const t=new Map;this.#Se({id:Le,caption:Le,items:this.model},{defaultCheckbox:this.checkbox,defaultChecked:this.checked,filter:this.filter,filterOptions:this.filterOptions,filterSet:this.#ae},e,t);this.#ke(e);this.#xe(t);this.#Ee()};if(e&&this.#ne!=="immediate"){this.#re=setTimeout((()=>{this.#ne=undefined;t();o(this)}),this.filterDebounce)}else{this.#ne=undefined;t()}};#Ee=()=>{if(this.#te){this.#Te();this.#te=false}if(this.#ee){this.#ee=false;this.#we()}};#Le=()=>{const e=new Map;this.#X.forEach((t=>{const i=this.#G.get(t);const s=i.item;e.set(t,{id:s.id,expanded:s.expanded,metadata:s.metadata,parentId:i.parentItem.id})}));return e};connectedCallback(){this.#h||=`ch-tree-view-render-${Ee++}`;C(this.#h,{getSubscriberRef:()=>this.el,observerCallback:e=>{this.expanded=e}});_(this.#h);this.el.setAttribute("role","tree")}componentWillLoad(){this.#le()}componentWillRender(){if(!this.#ee&&!this.#te&&!this.#se){return}if(this.#se){this.#$e();this.#se=false;return}this.#Ee()}disconnectedCallback(){I(this.#h)}render(){return r(a,{key:"412e10f508160f0a20723000682697b29ad6075a","aria-multiselectable":this.multiSelection.toString()},r("ch-tree-view",{key:"6ef48366798e6e8a7e77b78b11ce5bcb134c9212",multiSelection:this.multiSelection,selectedItemsCallback:this.#Le,waitDropProcessing:this.waitDropProcessing,onDroppableZoneEnter:this.#ye,onExpandedItemChange:this.#Ie,onItemContextmenu:this.#_e,onItemsDropped:this.#ze,onSelectedItemsChange:this.#Ce,ref:e=>this.#oe=e},this.model.map(((e,t)=>this.renderItem(e,this,this.#ve(),this.showLines!=="none"&&t===this.model.length-1,0,this.dropMode!=="above"&&this.dropDisabled!==true,this.useGxRender)))))}static get watchers(){return{filter:["filterChanged"],filterDebounce:["filterDebounceChanged"],filterList:["filterListChanged"],filterOptions:["filterOptionsChanged"],filterType:["filterTypeChanged"],multiSelection:["multiSelectionChanged"],model:["modelChanged"]}}};We.style=$e;export{U as ch_tree_view,oe as ch_tree_view_drop,ke as ch_tree_view_item,We as ch_tree_view_render};
//# sourceMappingURL=p-5e405e87.entry.js.map