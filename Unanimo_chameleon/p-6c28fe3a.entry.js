import{r as t,g as s,f as e,h as n}from"./p-7af91c05.js";import{R as i,r as o,a as r,b as c,c as a,d as u}from"./p-0978aac4.js";import{r as l,i as d}from"./p-23a9d308.js";import{S as f}from"./p-2a2bca47.js";const h="--ch-layout-splitter-fixed-sizes-sum";const m=0;const p=t=>{const s=t.item.id;return t.parentItem.items.findIndex((t=>t.id===s))};const b=(t,s)=>s==="columns"?t.clientX:t.clientY;const x=(t,s)=>s==="columns"?t.left:t.top;const z=t=>Number(t.size.replace("fr","").trim());const v=(t,s="size")=>{const e=s==="size"?t.size:t.minSize;return Number(e.replace("px","").trim())};const g=t=>t.size.includes("px");const y=t=>t.minSize&&t.minSize!=="0px";const w=t=>!g(t.item)&&y(t.item)?`minmax(${t.item.minSize},${t.actualSize})`:t.actualSize;const $=(t,s,e)=>t.map(((t,n)=>t.dragBar?.hidden!==true&&n!==e?`${w(s.get(t.id))} ${t.dragBar?.size??0}px`:w(s.get(t.id)))).join(" ");const S=t=>{const s=z(t);const e=`${s*100}%`;return t.fixedOffsetSize?`calc(${e} + var(${h}) * ${-s} + ${t.fixedOffsetSize}px)`:`calc(${e} + var(${h}) * ${-s})`};const k=t=>g(t)?t.size:S(t);const _=(t,s)=>{const e=`${s}px`;t.item.size=e;t.actualSize=e};const I=(t,s)=>_(t,v(t.item)+s);const R=(t,s)=>{const e=`${s}fr`;t.item.size=e;t.actualSize=S(t.item)};const D=(t,s)=>R(t,z(t.item)+s);const M=(t,s)=>{const e=t.item;e.fixedOffsetSize=s;t.actualSize=k(e)};const A=(t,s)=>M(t,s+(t.item.fixedOffsetSize??0));const C=t=>{if(y(t)&&v(t)<v(t,"min")){t.size=t.minSize}};const j=(t,s)=>{const e=t.container.querySelector(`[id="${s.item.id}"]`);return t.direction==="columns"?e.clientWidth:e.clientHeight};const B=(t,s,e)=>{if(e.mouseEvent===undefined){return{status:"ok"}}const n=e.dragBar.getBoundingClientRect();const i=x(n,e.direction);const o=b(e.mouseEvent,e.direction);if(t===0){const t=e.direction==="columns"&&e.RTL?o>i:o<i;if(t){return{status:"deny"}}}if(s===0){const t=e.direction==="columns"&&e.RTL?o<i:o>i;if(t){return{status:"deny"}}}return{status:"ok"}};const L=(t,s,e,n,i,o)=>{const r=y(t.item)?v(t.item,"min"):m;const c=e==="px"?v(t.item):j(o,t);const a=c-r;if(a+i<=0){return{status:a===0?"deny":"not-enough-space",availableIncrement:a}}const u=y(s.item)?v(s.item,"min"):m;const l=n==="px"?v(s.item):j(o,s);const d=l-u;if(d-i<=0){return{status:d===0?"deny":"not-enough-space",availableIncrement:d}}return B(a,d,o)};const F=(t,s)=>H(t.items,s,i);function H(t,s,e){let n=0;let i=0;const o=t.length-1;t.forEach(((t,s)=>{if(g(t)){C(t);i+=v(t)}else{n+=z(t)}i+=(t.fixedOffsetSize??0)+(s!==o?t.dragBar?.size??0:0)}));if(n>0){t.forEach((t=>{if(!g(t)){const s=z(t);const e=s/n;t.size=`${e}fr`}}))}t.forEach((t=>{const n={item:t,parentItem:e,actualSize:k(t)};if(t.items!=null){const e=t;const i=H(e.items,s,e);n.fixedSizesSum=i}s.set(t.id,n)}));return i}const P={"px-px":(t,s,e)=>{I(t,e);I(s,-e)},"px-fr":(t,s,e)=>{I(t,e);A(s,-e)},"fr-px":(t,s,e)=>{A(t,e);I(s,-e)},"fr-fr":(t,s,e,n)=>{const i=e/n;D(t,i);D(s,-i)}};const T=(t,s,e,n,i)=>{const o=g(t.item)?"px":"fr";const r=g(s.item)?"px":"fr";let c=e;const a=L(t,s,o,r,e,i);if(a.status==="deny"){return false}if(a.status==="not-enough-space"){c=a.availableIncrement*Math.sign(c)}P[`${o}-${r}`](t,s,c,n);return true};const E=(t,s,e,n)=>{const o=t.direction==="columns"&&t.RTL?-e:e;const r=s.get(t.itemStartId);const c=s.get(t.itemEndId);const a=r.parentItem===i?t.fixedSizesSumRoot:s.get(r.parentItem.id).fixedSizesSum;const u=t.layoutItems;const l=t.containerSize-a;const d=T(r,c,o,l,t);if(!d){return}t.container.style.setProperty(n,$(u,s,u.length-1));t.dragBar.ariaValueText=r.actualSize};const N=0;const O=(t,s)=>{const e=s.get(t);let n=undefined;let i=N;if(!e){return{success:false,reconnectedSubtree:n,fixedSizesSumDecrement:i}}const o=[];const r=p(e);const c=e.parentItem;const a=c.items;const u=r===0?1:r-1;const d=a[u];o.push([a,r,t]);if(a.length>2){i=U(e,s.get(d.id))}else if(a.length===2){const t=s.get(c.id);const e=s.get(d.id);n={nodeToRemove:d.id,nodeToReconnect:c.id};if(d.items!=null){d.items.forEach((t=>{s.get(t.id).parentItem=c}))}t.fixedSizesSum=e.fixedSizesSum;delete c.items;Object.keys(d).forEach((t=>{if(t!=="id"&&t!=="size"&&t!=="dragBar"&&t!=="fixedOffsetSize"){c[t]=d[t]}}));s.delete(d.id)}else;o.forEach((t=>{l(t[0],t[1]);s.delete(t[2])}));return{success:true,reconnectedSubtree:n,fixedSizesSumDecrement:i}};function U(t,s,e){const n=t.item;const i=s.item;if(g(n)&&g(i)){I(s,v(n));return N}if(g(n)){const t=v(n);let e=t;const o=i.fixedOffsetSize;if(o!=null){e+=o;A(s,-o)}return e}if(g(i)){return N}if(n.fixedOffsetSize!=null){A(t,n.fixedOffsetSize)}const o=z(n)+z(i);R(s,o);return N}const K=(t,s,e,n,i,o)=>{const r=i.get(t);if(!r){return{success:false}}const c=i.get(s);if(!c){return{success:false}}const a=p(c);const u=e==="before"?a:a+1;const l=r.item.items;if(u===l.length){l.push(n)}else{d(l,n,u)}const f={item:n,parentItem:r.item,actualSize:undefined};if(o){const t=g(c.item);const s=(t?v(c.item):z(c.item))/2;if(t){_(f,s);_(c,s)}else{const t=c.item.fixedOffsetSize;if(t){M(f,t/2);M(c,t/2)}R(f,s);R(c,s)}}i.set(n.id,f);return{success:true,fixedSizesSumIncrement:n.dragBar?.size}};const V='*,::after,::before{-webkit-box-sizing:border-box;box-sizing:border-box}:host{--ch-drag-bar__size:5px;display:grid;position:relative;block-size:100%;inline-size:100%}.bar{--position-fix:calc((var(--size, 0px) - var(--ch-drag-bar__size)) / 2);position:relative;inline-size:100%;block-size:100%;background-color:currentColor;z-index:1}.bar[aria-disabled]{pointer-events:none}.bar:focus-visible{outline:unset}.bar::after{content:"";display:-ms-flexbox;display:flex;position:absolute;background-color:currentColor;opacity:0;-webkit-transition:opacity 0s linear;transition:opacity 0s linear}.bar:is(:active,:focus-visible,:hover)::after{opacity:1}.bar:hover::after{-webkit-transition-delay:250ms;transition-delay:250ms}.leaf{display:grid}.group{display:grid;position:relative}.direction--columns{grid-template-columns:var(--ch-layout-splitter__distribution)}.direction--columns>.bar{cursor:ew-resize}.direction--columns>.bar::after{block-size:100%;inline-size:var(--ch-drag-bar__size);-webkit-margin-start:var(--position-fix);margin-inline-start:var(--position-fix)}.direction--rows{grid-template-rows:var(--ch-layout-splitter__distribution)}.direction--rows>.bar{cursor:ns-resize}.direction--rows>.bar::after{block-size:var(--ch-drag-bar__size);inline-size:100%;-webkit-margin-before:var(--position-fix);margin-block-start:var(--position-fix)}';const q=V;const G="--ch-layout-splitter__distribution";const J=t=>`group direction--${t}`;const Q=(t,s,e)=>({[G]:$(t,s,t.length-1),[h]:`${e}px`});const W=(t,s)=>`${t[s].id} ${t[s+1].id}`;const X="ArrowUp";const Y="ArrowRight";const Z="ArrowDown";const tt="ArrowLeft";const st=class{constructor(s){t(this,s);this.barAccessibleName="Resize";this.dragBarDisabled=false;this.incrementWithKeyboard=2;this.model={id:"root",direction:"columns",items:[]}}#t;#s;#e;#n;#i;#o=new Map;get el(){return s(this)}modelChanged(t){this.#r(t)}async refreshLayout(){e(this)}async addSiblingLeaf(t,s,n,o,r){const c=K(t,s,n,o,this.#o,r);if(c.success){const s=c.fixedSizesSumIncrement;if(s){const e=this.#o.get(t).parentItem;if(e===i){this.#i+=s}else{this.#o.get(e.id).fixedSizesSum+=s}}e(this)}return c}async removeItem(t){const s=this.#o.get(t).parentItem;const n=O(t,this.#o);if(n.success){const t=n.fixedSizesSumDecrement;if(t!==N){if(s===i){this.#i-=t}else{this.#o.get(s.id).fixedSizesSum-=t}}e(this)}return n}#c=t=>{t.preventDefault();this.#n=b(t,this.#s.direction);this.#s.mouseEvent=t;this.#t.perform(this.#a)};#a=t=>{E(this.#s,this.#o,t??this.#n-this.#e,G);this.#e=this.#n};#u=()=>{document.removeEventListener("mousemove",this.#c,{capture:true})};#l=()=>{if(this.#t){this.#t.cancel()}this.#u();o();r();document.removeEventListener("mouseup",this.#l,{capture:true})};#d=(t,s,e,n)=>{const i=n.target;const o=i.parentElement;this.#s={container:o,containerSize:t==="columns"?o.clientWidth:o.clientHeight,direction:t,dragBar:i,fixedSizesSumRoot:this.#i,itemStartId:e[s].id,itemEndId:e[s+1].id,layoutItems:e,mouseEvent:undefined,RTL:c()}};#f=(t,s,e)=>n=>{n.preventDefault();this.#t??=new f;this.#d(t,s,e,n);a(t==="columns"?"ew-resize":"ns-resize");u();const i=b(n,t);this.#e=i;this.#n=i;document.addEventListener("mousemove",this.#c,{capture:true});document.addEventListener("mouseup",this.#l,{capture:true,passive:true})};#h=(t,s,e)=>n=>{if(t==="rows"&&n.code!==X&&n.code!==Z||t==="columns"&&n.code!==tt&&n.code!==Y){return}n.preventDefault();this.#d(t,s,e,n);const i=n.code===Y||n.code===Z;this.#a(i?this.incrementWithKeyboard:-this.incrementWithKeyboard)};#m=(t,s,e,i,o)=>{const r=this.#o.get(i.id);return[i.items?n("div",{id:i.id,class:J(i.direction),part:i.id,style:Q(i.items,this.#o,r.fixedSizesSum)},this.#p(i.direction,i.items,i.items.length-1)):n("div",{id:i.id,class:"leaf"},n("slot",{key:i.id,name:i.id})),i.dragBar?.hidden!==true&&o!==s&&n("div",{role:"separator","aria-controls":W(e,o),"aria-disabled":this.dragBarDisabled?"true":null,"aria-label":this.barAccessibleName,"aria-orientation":t==="columns"?"vertical":"horizontal","aria-valuetext":r.actualSize,title:this.barAccessibleName,tabindex:"0",class:"bar",part:i.dragBar?.part?`bar ${i.dragBar.part}`:"bar",style:i.dragBar?.size?{"--size":`${i.dragBar.size}px`}:null,onKeyDown:!this.dragBarDisabled?this.#h(t,o,e):null,onMouseDown:!this.dragBarDisabled?this.#f(t,o,e):null})]};#p=(t,s,e)=>s.map(((n,i)=>this.#m(t,e,s,n,i)));#r=t=>{this.#o.clear();if(t?.items?.length>0){this.#i=F(t,this.#o)}};connectedCallback(){this.#r(this.model)}disconnectedCallback(){this.#l()}render(){const t=this.model;if(t?.items==null){return""}return n("div",{class:J(t.direction),style:Q(t.items,this.#o,this.#i)},this.#p(t.direction,t.items,t.items.length-1))}static get watchers(){return{model:["modelChanged"]}}};st.style=q;export{st as ch_layout_splitter};
//# sourceMappingURL=p-6c28fe3a.entry.js.map