import{r as t,c as i,g as s,h as e,H as n}from"./p-7af91c05.js";import{b as a}from"./p-79129d9d.js";const o=":host{--ch-window-offset-x:0px;--ch-window-offset-y:0px;--ch-window-separation-x:0px;--ch-window-separation-y:0px;--ch-window-x-outside:0px;--ch-window-y-outside:0px}:host(:not([hidden])){display:contents}:host(:is(:not([modal]),[modal=false])) .mask{pointer-events:none}.window{pointer-events:all}.mask{display:-ms-flexbox;display:flex;position:fixed;inset:0;left:calc(var(--ch-window-inset-inline-start) + var(--ch-window-offset-x) + var(--ch-window-separation-x));inset-block-start:calc(var(--ch-window-inset-block-start) + var(--ch-window-offset-y) + var(--ch-window-separation-y));width:var(--ch-window-mask-width);height:var(--ch-window-mask-height);z-index:var(--ch-window-mask-z-index, 1000)}:host(:is([x-align=outside-start],[x-align=inside-start])) .mask{-ms-flex-pack:start;justify-content:flex-start}:host([x-align=center]) .mask{-ms-flex-pack:center;justify-content:center}:host(:is([x-align=outside-end],[x-align=inside-end])) .mask{-ms-flex-pack:end;justify-content:flex-end}:host(:is([y-align=outside-start],[y-align=inside-start])) .mask{-ms-flex-align:start;align-items:flex-start}:host([y-align=center]) .mask{-ms-flex-align:center;align-items:center}:host(:is([y-align=outside-end],[y-align=inside-end])) .mask{-ms-flex-align:end;align-items:flex-end}.window{display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;-webkit-transform:translate(var(--ch-window-x-outside), var(--ch-window-y-outside)) translate(var(--ch-window-x-drag, 0px), var(--ch-window-y-drag, 0px));transform:translate(var(--ch-window-x-outside), var(--ch-window-y-outside)) translate(var(--ch-window-x-drag, 0px), var(--ch-window-y-drag, 0px));z-index:inherit}:host([x-align=outside-start]) .window{--ch-window-x-outside:-100%}:host([x-align=outside-end]) .window{--ch-window-x-outside:100%}:host([y-align=outside-start]) .window{--ch-window-y-outside:-100%}:host([y-align=outside-end]) .window{--ch-window-y-outside:100%}.separation{position:fixed;inset:0;pointer-events:all}.separation--x{top:var(--ch-window-inset-block-start);width:var(--ch-window-separation);height:var(--ch-window-mask-height)}.separation--y{left:var(--ch-window-inset-inline-start);width:var(--ch-window-mask-width);height:var(--ch-window-separation)}.separation--both{width:calc(var(--ch-window-separation) * 4);height:calc(var(--ch-window-separation) * 4)}:host([x-align=outside-start]) .separation{left:calc(var(--ch-window-inset-inline-start) - var(--ch-window-separation))}:host([x-align=outside-start]) .separation--both{left:calc(var(--ch-window-inset-inline-start) - var(--ch-window-separation) * 3)}:host([x-align=outside-end]) .separation{left:calc(var(--ch-window-inset-inline-start) + var(--ch-window-mask-width))}:host([x-align=outside-end]) .separation--both{left:calc(var(--ch-window-inset-inline-start) + var(--ch-window-mask-width) - var(--ch-window-separation))}:host([y-align=outside-start]) .separation{top:calc(var(--ch-window-inset-block-start) - var(--ch-window-separation))}:host([y-align=outside-start]) .separation--both{top:calc(var(--ch-window-inset-block-start) - var(--ch-window-separation) * 3)}:host([y-align=outside-end]) .separation{top:calc(var(--ch-window-inset-block-start) + var(--ch-window-mask-height))}:host([y-align=outside-end]) .separation--both{top:calc(var(--ch-window-inset-block-start) + var(--ch-window-mask-height) - var(--ch-window-separation))}";const d=o;const h="--ch-window-relative-position";const r=class{constructor(s){t(this,s);this.windowOpened=i(this,"windowOpened",7);this.windowClosed=i(this,"windowClosed",7);this.container=undefined;this.xAlign="center";this.yAlign="center";this.hidden=true;this.modal=true;this.caption="";this.closeText=undefined;this.closeTooltip=undefined;this.closeOnOutsideClick=undefined;this.closeOnEscape=undefined;this.allowDrag="no";this.showFooter=true;this.showHeader=true;this.showMain=true;this.showSeparation=false}isContainerCssOverride=false;relativeWindow=false;containerResizeObserver;mask;header;window;validCssAligns=["outside-start","inside-start","center","inside-end","outside-end"];dragStartX;dragStartY;draggedX=0;draggedY=0;get el(){return s(this)}containerHandler(t,i){this.checkRelativePosition();this.containerResizeObserverHandler(t,i);this.updatePosition()}hiddenHandler(){if(this.hidden){this.resetDrag();this.removeListeners();this.windowClosed.emit()}else{this.checkRelativePosition();this.updatePosition();this.watchCSSAlign();this.addListeners();this.windowOpened.emit()}}windowOpened;windowClosed;componentWillLoad(){this.containerResizeObserver=new ResizeObserver(this.updatePosition);this.containerResizeObserverHandler(this.container);this.watchCSSAlign();this.loadGlobalStyleSheet()}componentDidLoad(){if(!this.hidden){this.addListeners()}}mousedownHandler(t){if(this.isDraggable(t.composedPath())){this.dragStartX=t.clientX;this.dragStartY=t.clientY;document.addEventListener("mousemove",this.mousemoveHandler,{passive:true});document.addEventListener("mouseup",this.mouseupHandler,{once:true})}}windowCloseClickedHandler(){this.hidden=true}mousemoveHandler=t=>{const i=this.draggedX+t.clientX-this.dragStartX;const s=this.draggedY+t.clientY-this.dragStartY;this.window.style.setProperty("--ch-window-x-drag",`${i}px`);this.window.style.setProperty("--ch-window-y-drag",`${s}px`)};mouseupHandler=()=>{document.removeEventListener("mousemove",this.mousemoveHandler);this.draggedX=parseInt(this.window.style.getPropertyValue("--ch-window-x-drag"));this.draggedY=parseInt(this.window.style.getPropertyValue("--ch-window-y-drag"))};maskClickHandler=t=>{t.stopPropagation()};checkRelativePosition(){const t=getComputedStyle(this.el);this.relativeWindow=!!t.getPropertyValue(h)}updatePosition=()=>{if(!this.isContainerCssOverride&&this.container&&this.mask){const t=this.container.getBoundingClientRect();this.el.style.setProperty("--ch-window-mask-width",`${t.width}px`);this.el.style.setProperty("--ch-window-mask-height",`${t.height}px`);if(this.relativeWindow){return}this.el.style.setProperty("--ch-window-inset-inline-start",`${t.left}px`);this.el.style.setProperty("--ch-window-inset-block-start",`${t.top}px`)}else if(this.isContainerCssOverride||!this.container){this.el.style.removeProperty("--ch-window-mask-width");this.el.style.removeProperty("--ch-window-mask-height");if(this.relativeWindow){return}this.el.style.removeProperty("--ch-window-inset-inline-start");this.el.style.removeProperty("--ch-window-inset-block-start")}};resetDrag(){this.dragStartX=undefined;this.dragStartY=undefined;this.draggedX=0;this.draggedY=0;this.window.style.removeProperty("--ch-window-x-drag");this.window.style.removeProperty("--ch-window-y-drag")}isDraggable(t){return this.allowDrag!=="no"&&(this.allowDrag==="header"&&t.includes(this.header)||this.allowDrag==="box"&&t.includes(this.window))}watchCSSAlign(){const t=getComputedStyle(this.el);const i=t.getPropertyValue("--ch-window-container").trim();const s=t.getPropertyValue("--ch-window-align-x").trim();const e=t.getPropertyValue("--ch-window-align-y").trim();this.isContainerCssOverride=i.includes("window");if(this.validCssAligns.includes(s)){this.xAlign=s}if(this.validCssAligns.includes(e)){this.yAlign=e}}containerResizeObserverHandler(t,i){if(t){this.containerResizeObserver.observe(t)}if(i){this.containerResizeObserver.unobserve(i)}}addListeners(){window.addEventListener("resize",this.windowResizeHandler,{passive:true});if(this.container){document.addEventListener("scroll",this.windowScrollHandler,{capture:true,passive:true})}if(this.closeOnOutsideClick){document.addEventListener("click",this.closeOnOutsideClickHandler,{capture:true})}if(this.closeOnEscape){document.addEventListener("keydown",this.closeOnEscapeHandler,{capture:true})}}removeListeners(){window.removeEventListener("resize",this.windowResizeHandler);document.removeEventListener("scroll",this.windowScrollHandler,{capture:true});document.removeEventListener("click",this.closeOnOutsideClickHandler,{capture:true});document.removeEventListener("keydown",this.closeOnEscapeHandler,{capture:true})}windowResizeHandler=()=>{this.updatePosition();this.watchCSSAlign()};windowScrollHandler=()=>{this.updatePosition()};closeOnOutsideClickHandler=t=>{if(!t.composedPath().includes(this.window)){this.hidden=true}};closeOnEscapeHandler=t=>{if(t.key==="Escape"){this.hidden=true}};loadGlobalStyleSheet(){a(this.el.shadowRoot.adoptedStyleSheets)}render(){const t=this.yAlign==="outside-start"||this.yAlign==="outside-end";const i=this.xAlign==="outside-start"||this.xAlign==="outside-end";return e(n,{key:"982821f7de3dde03801407d39c553762148f8696",style:this.relativeWindow&&{"--ch-window-inset-inline-start":"0px","--ch-window-inset-block-start":"0px"}},e("div",{key:"f9faf2ee86d8f8ebd0baf5f47e3b651f44edae61",class:"mask",part:"mask",ref:t=>this.mask=t,onClick:this.maskClickHandler},e("section",{key:"38fefaa8e6a952c32c52388ae5572af0a785324f",class:"window",part:"window",ref:t=>this.window=t},this.showHeader&&e("header",{key:"040c9feecc3f7d6f2c8677106adfa24010d03e09",part:"header",ref:t=>this.header=t},e("slot",{key:"8d9c3e14ba5f68f3bf005fefd8697af6c08fb4df",name:"header"},e("span",{key:"d27f55b3906940af188051e45a359d11040b8563",part:"caption"},this.caption),e("ch-window-close",{key:"65a02494cb2d705959263b10b85539f765148664",part:"close",title:this.closeTooltip},this.closeText))),this.showMain?e("div",{part:"main"},e("slot",null)):e("slot",null),this.showFooter&&e("footer",{key:"60755221bba784464cd9d53ad128f2970f2f7f3c",part:"footer"},e("slot",{key:"df6d84ce1a344d371a9c044597701247f8d7c501",name:"footer"}))),this.showSeparation&&e("div",{key:"bb988462dcd11347dd74d3bfcdbcf7b0c13d3fa5",class:{separation:true,"separation--x":i&&!t,"separation--y":t&&!i,"separation--both":i&&t},part:"separation"})))}static get watchers(){return{container:["containerHandler"],hidden:["hiddenHandler"]}}};r.style=d;const c="";const w=c;const l=class{constructor(s){t(this,s);this.windowCloseClicked=i(this,"windowCloseClicked",7);this.disabled=undefined}windowCloseClicked;pressedHandler(t){if(!t.key||t.key==="Enter"||t.key===" "){this.windowCloseClicked.emit();t.stopPropagation()}}render(){return e(n,{key:"a56855995f62d9ee2d2e56b6f5f69081a64f2f8b",role:"button",tabindex:"0",disabled:this.disabled})}};l.style=w;export{r as ch_window,l as ch_window_close};
//# sourceMappingURL=p-8f5d6b9f.entry.js.map